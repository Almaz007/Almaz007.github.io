import{r as C,j as g,d as F,I as an,a as A,e as je,f as De,h as on,E as rn,k as R,l as N,m as sn,n as Le,v as ln,o as it,u as mt,b as yt,p as cn,H as un,q as oe,N as dn,s as pn,t as fn,w as gn,x as hn,y as mn,z as yn,A as vn,D as bn,G as xn,J as En,K as Cn,M as In,O as _n,c as wn,Q as kn,S as re,T as Tn}from"./index-CrREYRkc.js";import{s as ot}from"./shallow-BHpKla55.js";import{I as pt}from"./Input-i71ZKPRw.js";import{B as Bt}from"./Button-C6bKAtMY.js";import{i as Me,a as Sn,u as Be}from"./store-BUSY_6ZW.js";import{u as $e}from"./store-CwyoiMnS.js";import{u as Vt}from"./store-CG8v_uPG.js";import{u as te}from"./store-Du-GoxsD.js";import{u as ee,p as Rt}from"./pako.esm-B2G-gnns.js";import{o as U,a as $,s as V,b as Ve,u as ce,l as Nt,n as W,e as Nn,c as On,r as ue,t as Hn}from"./types-CM2LPTMF.js";const jn="_popup_cjxb8_1",Dn="_left_cjxb8_61",Ln="_center_cjxb8_67",Mn="_right_cjxb8_75",Bn="_visible_cjxb8_81",$n="_popup__label_cjxb8_91",bt={popup:jn,"popup-content":"_popup-content_cjxb8_11",left:Dn,center:Ln,right:Mn,visible:Bn,popup__label:$n},Vn=({text:t,children:e,position:o})=>{const[a,n]=C.useState(!1),r=C.useRef(null);C.useEffect(()=>{const i=l=>{r.current&&l.target instanceof Node&&!r.current.contains(l.target)&&n(!1)};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[]);const s=i=>{i.stopPropagation(),n(l=>!l)};return g.jsxs("div",{className:bt.popup,ref:r,children:[g.jsx(Bt,{text:t,type:"button",onClick:s}),g.jsxs("div",{className:F(bt["popup-content"],bt[o],{[bt.visible]:a}),children:[g.jsx("div",{className:bt.popup__label,children:t}),g.jsx("div",{children:e})]})]})},Rn="_container_1y4rw_1",Pn="_header_1y4rw_19",An="_title_1y4rw_51",Wn="_arrow_1y4rw_63",Fn="_rotated_1y4rw_73",zn="_content_1y4rw_81",qn="_innerContent_1y4rw_91",J={container:Rn,header:Pn,title:An,arrow:Wn,rotated:Fn,content:zn,innerContent:qn},K=({name:t,children:e,defaultOpen:o=!1})=>{const[a,n]=C.useState(o),[r,s]=C.useState(0),i=C.useRef(null);C.useEffect(()=>{i.current&&s(i.current.scrollHeight)},[e]);const l=()=>{n(c=>!c)};return g.jsxs("div",{className:J.container,children:[g.jsxs("button",{className:J.header,onClick:l,"aria-expanded":a,children:[g.jsx("span",{className:J.title,children:t}),g.jsx(an,{className:F(J.arrow,{[J.rotated]:a})})]}),g.jsx("div",{ref:i,className:J.content,style:{height:a?`${r}px`:"0px"},"aria-hidden":!a,children:g.jsx("div",{className:J.innerContent,children:e})})]})},zo=t=>({nodes:t.nodes,edges:t.edges,onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange,addEdge:t.addEdge,updateNodes:t.updateNodes,updateEdges:t.updateEdges,isDirty:t.isDirty,setDirty:t.setDirty,resetDirty:t.resetDirty}),Un={discreteInput:{outputHandles:{out:{dataType:"bool"}},inputHandles:{},type:"discreteInput",name:""},discreteOutput:{inputHandles:{input:{dataType:"bool"}},outputHandles:{},type:"discreteOutput",name:""},discreteOutputConnect:{inputHandles:{input:{dataType:"bool"}},outputHandles:{},type:"discreteOutputConnect",name:""},discreteInputConnect:{outputHandles:{out:{dataType:"bool"}},inputHandles:{},type:"discreteInputConnect",name:""},analogInputConnect:{outputHandles:{out:{dataType:"analog"}},inputHandles:{},type:"analogInputConnect"},analogOutputConnect:{inputHandles:{input:{dataType:"analog"}},outputHandles:{},type:"analogOutputConnect",name:""},analogInputIntConnect:{outputHandles:{out:{dataType:"int"}},inputHandles:{},type:"analogInputIntConnect"},analogOutputIntConnect:{inputHandles:{input:{dataType:"int"}},outputHandles:{},type:"analogOutputIntConnect"},analogInput:{outputHandles:{out:{dataType:"analog"}},inputHandles:{},type:"analogInput"},analogInputInt:{outputHandles:{out:{dataType:"int"}},inputHandles:{},type:"analogInputInt"},analogOutput:{inputHandles:{input:{dataType:"analog"}},outputHandles:{},type:"analogOutput",name:""},xor:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"xor"},and:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"and"},or:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"or"},nand:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"nand"},nor:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"nor"},notOperation:{inputHandles:{"input-1":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"notOperation"},sumInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int"}},type:"sumInt"},multInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int"}},type:"multInt"},divInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int"}},type:"divInt"},subInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int"}},type:"subInt"},equalsInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool"}},type:"equalsInt"},lessInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool"}},type:"lessInt"},moreInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool"}},type:"moreInt"},timerInt:{inputHandles:{},outputHandles:{out:{dataType:"int"}},setpointDataType:"int",setpointValue:0,type:"timerInt",name:""},risEdgeTimerBool:{inputHandles:{"input-1":{dataType:"bool"}},outputHandles:{out:{dataType:"bool"}},type:"risEdgeTimerBool",digit:0,name:""},constInt:{inputHandles:{},outputHandles:{out:{dataType:"int"}},setpointDataType:"int",setpointValue:0,type:"constInt",name:""},constBoolean:{inputHandles:{},outputHandles:{out:{dataType:"bool"}},setpointDataType:"int",setpointValue:0,type:"constBoolean",name:""},fourierInt:{inputHandles:{"input-1":{dataType:"analog"}},outputHandles:{"out-1":{dataType:"int"},"out-2":{dataType:"int"}},type:"fourierInt",setpointDataType:"int",setpointValue:[0,0,0,0]},fifoByte:{type:"fifoByte",lengthMemory:1,inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{"out-1":{dataType:"bool"}}},fifoWord:{type:"fifoWord",lengthMemory:1,inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"bool"}},outputHandles:{"out-1":{dataType:"int"}}},fifoByteWithoutEn:{type:"fifoByteWithoutEn",lengthMemory:1,inputHandles:{"input-1":{dataType:"bool"}},outputHandles:{"out-1":{dataType:"bool"}}},fifoWordWithoutEn:{type:"fifoWordWithoutEn",lengthMemory:1,inputHandles:{"input-1":{dataType:"int"}},outputHandles:{"out-1":{dataType:"int"}}},dtrigger:{inputHandles:{},outputHandles:{out:{dataType:"bool"}},type:"dtrigger"},rsTrigger:{type:"rsTrigger",name:"",inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{"out-1":{dataType:"bool"}}}},rt={discreteInput:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:33}},discreteOutput:{1:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:30}},analogInput:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:33}},analogInputInt:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:34}},analogOutput:{},dtrigger:{},multInt:{2:{instruction:[34,12,156,65,24,66,179,135,231,2,28,193,130,128],lengthInBytes:14,in_type:8}},divInt:{2:{instruction:[34,12,156,65,24,66,179,135,231,2,28,193,130,128],lengthInBytes:14,in_type:45}},subInt:{2:{instruction:[34,12,156,65,24,66,153,143,28,193,130,128],lengthInBytes:12,in_type:8}},sumInt:{2:{instruction:[34,12,156,65,24,66,186,151,28,193,130,128],lengthInBytes:12,in_type:8},3:{instruction:[130,128,24,66,156,65,186,151,152,66,186,151,28,193,130,128],lengthInBytes:16,in_type:9},4:{instruction:[130,128,156,65,16,66,148,66,24,67,178,151,182,151,186,151,28,193,130,128],lengthInBytes:20,in_type:10},5:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,12,193,130,128],lengthInBytes:24,in_type:11},6:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,131,39,8,0,190,149,12,193,130,128],lengthInBytes:30,in_type:12},7:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,131,39,8,0,190,149,131,167,8,0,190,149,12,193,130,128],lengthInBytes:36,in_type:13}},notOperation:{1:{instruction:[34,12,131,199,5,0,147,199,23,0,35,0,245,0,130,128],lengthInBytes:16,in_type:1}},and:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},nand:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:22,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:28,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:34,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,19,71,23,0,35,0,229,0,130,128],lengthInBytes:40,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:48,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,19,72,24,0,35,0,5,1,130,128],lengthInBytes:64,in_type:7}},nor:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:22,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:28,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:34,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,19,71,23,0,35,0,229,0,130,128],lengthInBytes:40,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:48,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,19,72,24,0,35,0,5,1,130,128],lengthInBytes:64,in_type:7}},or:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,217,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,217,143,3,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,93,143,131,199,6,0,93,143,131,71,6,0,93,143,131,199,5,0,93,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,231,7,1,217,143,3,199,6,0,217,143,3,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,104,24,1,51,104,248,0,131,71,7,0,51,104,248,0,131,199,6,0,51,104,248,0,131,71,6,0,51,104,248,0,131,199,5,0,51,104,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},xor:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,185,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,185,143,3,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,61,143,131,199,6,0,61,143,131,71,6,0,61,143,131,199,5,0,61,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,199,7,1,185,143,3,199,6,0,185,143,3,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,72,24,1,51,72,248,0,131,71,7,0,51,72,248,0,131,199,6,0,51,72,248,0,131,71,6,0,51,72,248,0,131,199,5,0,51,72,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},equalsInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,21,247,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},equalsFloat:{},moreInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,213,231,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},moreFloat:{},lessInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,85,247,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},lessFloat:{},constInt:{0:{instruction:[34,12,156,65,28,193,130,128],lengthInBytes:8,in_type:28}},constBoolean:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:8,in_type:29}},timerInt:{0:{instruction:[34,12,28,65,133,7,28,193,152,65,99,84,247,0,35,32,5,0,130,128],lengthInBytes:20,in_type:27}},risEdgeTimerBool:{1:{instruction:[131,130,5,0,19,3,16,0,99,132,98,0,111,0,192,0,19,3,16,0,35,160,102,0,131,163,6,0,19,14,16,0,99,200,195,3,99,204,195,0,147,3,0,0,35,160,118,0,19,3,0,0,35,0,101,0,103,128,0,0,147,131,19,0,35,160,118,0,19,3,16,0,35,0,101,0,103,128,0,0,19,3,0,0,35,0,101,0,103,128,0,0],lengthInBytes:92,in_type:46}},fourierInt:{1:{instruction:[],lengthInBytes:0,in_type:36},2:{instruction:[],lengthInBytes:0,in_type:37},3:{instruction:[],lengthInBytes:0,in_type:38}},fifoByte:{2:{instruction:[3,71,7,0,13,195,152,67,99,100,183,0,35,160,7,0,131,198,6,0,152,67,42,151,35,0,215,0,152,67,5,7,99,122,183,0,152,195,156,67,62,149,131,71,5,0,35,0,246,0,130,128,35,160,7,0,253,183,130,128],lengthInBytes:60,in_type:41}},fifoWord:{2:{instruction:[3,71,7,0,5,195,152,67,99,100,183,0,35,160,7,0,148,66,152,67,51,71,167,32,20,195,152,67,5,7,99,121,183,0,152,195,156,67,51,197,167,32,28,65,28,194,130,128,35,160,7,0,197,191,130,128],lengthInBytes:56,in_type:42}},fifoByteWithoutEn:{1:{instruction:[28,67,99,228,183,0,35,32,7,0,148,66,28,67,179,199,167,32,148,195,20,67,147,135,22,0,179,181,183,0,179,5,176,64,237,143,28,195,179,199,167,32,156,67,28,194,130,128],lengthInBytes:48,in_type:43}},fifoWordWithoutEn:{1:{instruction:[28,67,99,228,183,0,35,32,7,0,131,198,6,0,28,67,170,151,35,128,215,0,28,67,133,7,179,181,183,0,179,5,176,64,237,143,28,195,62,149,131,71,5,0,35,0,246,0,130,128],lengthInBytes:50,in_type:44}},rsTrigger:{2:{instruction:[131,130,5,0,19,3,16,0,99,138,98,0,131,2,6,0,19,3,16,0,99,138,98,0,103,128,0,0,19,3,16,0,35,0,101,0,111,240,159,254,19,3,0,0,35,0,101,0,103,128,0,0],lengthInBytes:52,in_type:2}}},ft={bool:{clr:"#00ff00",selectedClr:"#08d508"},int:{clr:"#368ff4",selectedClr:"#2b79d2"},float:{clr:"#ffe417",selectedClr:"#ead219"},analog:{clr:"#cd1fe8",selectedClr:"#ab2cbe"}},Kn={bool:void 0,analog:void 0,int:"circle",float:"arrow-closed"},qo={"graph-editor":"_graph-editor_3h800_1"},Ft={"button-edge__label":"_button-edge__label_t1jz9_1","button-txt":"_button-txt_t1jz9_55",delete:"_delete_t1jz9_81"},Xn=({id:t,source:e,sourceHandleId:o,sourceX:a,sourceY:n,targetX:r,targetY:s,selected:i,sourcePosition:l=R.Right,targetPosition:c=R.Left})=>{var f,k,T,H;const{getEdge:u,setEdges:p}=A(),m=je(D=>D.nodeLookup.get(e),ot),w=u(t);if(!m||!w||!o)return null;const v=o.split(" ")[1],I=m.data.outputHandles[v];if(!I)return null;const{dataType:x}=I,[d,y,h]=De({sourceX:a,sourceY:n,targetX:r,targetY:s,sourcePosition:l,targetPosition:c,borderRadius:8,offset:17}),b=i?(f=ft[x])==null?void 0:f.selectedClr:(k=ft[x])==null?void 0:k.clr,E=Kn[x],_=()=>{p(D=>D.filter(L=>L.id!==w.id))};return g.jsxs(g.Fragment,{children:[g.jsxs("defs",{children:[g.jsx("marker",{id:"circle",viewBox:"0 0 10 10",refX:9,refY:5,markerWidth:7,markerHeight:7,orient:"auto-start-reverse",children:g.jsx("circle",{cx:"6",cy:"5",r:"3",fill:(T=ft.int)==null?void 0:T.clr})}),g.jsx("marker",{id:"arrow-closed",viewBox:"0 0 10 10",refX:10,refY:5,markerWidth:8,markerHeight:8,orient:"auto-start-reverse",children:g.jsx("path",{d:"M 0 0 L 10 5 L 0 10 Z",fill:(H=ft.float)==null?void 0:H.clr})})]}),g.jsx(on,{id:t,path:d,style:{stroke:b,strokeWidth:3},markerEnd:E?`url(#${E})`:void 0}),i&&g.jsx(rn,{children:g.jsx("div",{className:F(Ft["button-edge__label"],"nodrag","nopan"),style:{transform:`translate(-50%, -140%) translate(${y}px,${h}px)`},children:g.jsx("button",{className:F(Ft["button-txt"],Ft.delete),onClick:_,children:"Удалить"})})})]})};function Re(t){var e,o,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(o=Re(t[e]))&&(a&&(a+=" "),a+=o);else for(e in t)t[e]&&(a&&(a+=" "),a+=e);return a}function lt(){for(var t,e,o=0,a="";o<arguments.length;)(t=arguments[o++])&&(e=Re(t))&&(a&&(a+=" "),a+=e);return a}let Gn={data:""},Yn=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Gn,Zn=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Jn=/\/\*[^]*?\*\/|  +/g,de=/\n+/g,nt=(t,e)=>{let o="",a="",n="";for(let r in t){let s=t[r];r[0]=="@"?r[1]=="i"?o=r+" "+s+";":a+=r[1]=="f"?nt(s,r):r+"{"+nt(s,r[1]=="k"?"":e)+"}":typeof s=="object"?a+=nt(s,e?e.replace(/([^,])+/g,i=>r.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,i):i?i+" "+l:l)):r):s!=null&&(r=/^--/.test(r)?r:r.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=nt.p?nt.p(r,s):r+":"+s+";")}return o+(e&&n?e+"{"+n+"}":n)+a},z={},Pe=t=>{if(typeof t=="object"){let e="";for(let o in t)e+=o+Pe(t[o]);return e}return t},Qn=(t,e,o,a,n)=>{let r=Pe(t),s=z[r]||(z[r]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(r));if(!z[s]){let l=r!==t?t:(c=>{let u,p,m=[{}];for(;u=Zn.exec(c.replace(Jn,""));)u[4]?m.shift():u[3]?(p=u[3].replace(de," ").trim(),m.unshift(m[0][p]=m[0][p]||{})):m[0][u[1]]=u[2].replace(de," ").trim();return m[0]})(t);z[s]=nt(n?{["@keyframes "+s]:l}:l,o?"":"."+s)}let i=o&&z.g?z.g:null;return o&&(z.g=z[s]),((l,c,u,p)=>{p?c.data=c.data.replace(p,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(z[s],e,a,i),s},ta=(t,e,o)=>t.reduce((a,n,r)=>{let s=e[r];if(s&&s.call){let i=s(o),l=i&&i.props&&i.props.className||/^go/.test(i)&&i;s=l?"."+l:i&&typeof i=="object"?i.props?"":nt(i,""):i===!1?"":i}return a+n+(s??"")},"");function se(t){let e=this||{},o=t.call?t(e.p):t;return Qn(o.unshift?o.raw?ta(o,[].slice.call(arguments,1),e.p):o.reduce((a,n)=>Object.assign(a,n&&n.call?n(e.p):n),{}):o,Yn(e.target),e.g,e.o,e.k)}se.bind({g:1});se.bind({k:1});function ea(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function Ae(t,e,o){return e&&ea(t.prototype,e),t}function O(){return O=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},O.apply(this,arguments)}function We(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function kt(t,e){if(t==null)return{};var o={},a=Object.keys(t),n,r;for(r=0;r<a.length;r++)n=a[r],!(e.indexOf(n)>=0)&&(o[n]=t[n]);return o}function pe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var fe=function(){return""},Fe=N.createContext({enqueueSnackbar:fe,closeSnackbar:fe}),et={downXs:"@media (max-width:599.95px)",upSm:"@media (min-width:600px)"},ge=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},ie=function(e){return""+ge(e.vertical)+ge(e.horizontal)},Ot=function(e){return!!e||e===0},Ht="unmounted",ct="exited",ut="entering",xt="entered",he="exiting",le=function(t){We(e,t);function e(a){var n;n=t.call(this,a)||this;var r=a.appear,s;return n.appearStatus=null,a.in?r?(s=ct,n.appearStatus=ut):s=xt:a.unmountOnExit||a.mountOnEnter?s=Ht:s=ct,n.state={status:s},n.nextCallback=null,n}e.getDerivedStateFromProps=function(n,r){var s=n.in;return s&&r.status===Ht?{status:ct}:null};var o=e.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(n){var r=null;if(n!==this.props){var s=this.state.status;this.props.in?s!==ut&&s!==xt&&(r=ut):(s===ut||s===xt)&&(r=he)}this.updateStatus(!1,r)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var n=this.props.timeout,r=n,s=n;return n!=null&&typeof n!="number"&&typeof n!="string"&&(s=n.exit,r=n.enter),{exit:s,enter:r}},o.updateStatus=function(n,r){n===void 0&&(n=!1),r!==null?(this.cancelNextCallback(),r===ut?this.performEnter(n):this.performExit()):this.props.unmountOnExit&&this.state.status===ct&&this.setState({status:Ht})},o.performEnter=function(n){var r=this,s=this.props.enter,i=n,l=this.getTimeouts();if(!n&&!s){this.safeSetState({status:xt},function(){r.props.onEntered&&r.props.onEntered(r.node,i)});return}this.props.onEnter&&this.props.onEnter(this.node,i),this.safeSetState({status:ut},function(){r.props.onEntering&&r.props.onEntering(r.node,i),r.onTransitionEnd(l.enter,function(){r.safeSetState({status:xt},function(){r.props.onEntered&&r.props.onEntered(r.node,i)})})})},o.performExit=function(){var n=this,r=this.props.exit,s=this.getTimeouts();if(!r){this.safeSetState({status:ct},function(){n.props.onExited&&n.props.onExited(n.node)});return}this.props.onExit&&this.props.onExit(this.node),this.safeSetState({status:he},function(){n.props.onExiting&&n.props.onExiting(n.node),n.onTransitionEnd(s.exit,function(){n.safeSetState({status:ct},function(){n.props.onExited&&n.props.onExited(n.node)})})})},o.cancelNextCallback=function(){this.nextCallback!==null&&this.nextCallback.cancel&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(n,r){r=this.setNextCallback(r),this.setState(n,r)},o.setNextCallback=function(n){var r=this,s=!0;return this.nextCallback=function(){s&&(s=!1,r.nextCallback=null,n())},this.nextCallback.cancel=function(){s=!1},this.nextCallback},o.onTransitionEnd=function(n,r){this.setNextCallback(r);var s=n==null&&!this.props.addEndListener;if(!this.node||s){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(this.node,this.nextCallback),n!=null&&setTimeout(this.nextCallback,n)},o.render=function(){var n=this.state.status;if(n===Ht)return null;var r=this.props,s=r.children,i=kt(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return s(n,i)},Ae(e,[{key:"node",get:function(){var n,r=(n=this.props.nodeRef)===null||n===void 0?void 0:n.current;if(!r)throw new Error("notistack - Custom snackbar is not refForwarding");return r}}]),e}(N.Component);function dt(){}le.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:dt,onEntering:dt,onEntered:dt,onExit:dt,onExiting:dt,onExited:dt};function me(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function ne(t,e){return C.useMemo(function(){return t==null&&e==null?null:function(o){me(t,o),me(e,o)}},[t,e])}function Pt(t){var e=t.timeout,o=t.style,a=o===void 0?{}:o,n=t.mode;return{duration:typeof e=="object"?e[n]||0:e,easing:a.transitionTimingFunction,delay:a.transitionDelay}}var ae={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},ze=function(e){e.scrollTop=e.scrollTop},ye=function(e){return Math.round(e)+"ms"};function gt(t,e){t===void 0&&(t=["all"]);var o=e||{},a=o.duration,n=a===void 0?300:a,r=o.easing,s=r===void 0?ae.easeInOut:r,i=o.delay,l=i===void 0?0:i,c=Array.isArray(t)?t:[t];return c.map(function(u){var p=typeof n=="string"?n:ye(n),m=typeof l=="string"?l:ye(l);return u+" "+p+" "+s+" "+m}).join(",")}function na(t){return t&&t.ownerDocument||document}function qe(t){var e=na(t);return e.defaultView||window}function aa(t,e){e===void 0&&(e=166);var o;function a(){for(var n=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var l=function(){t.apply(n,s)};clearTimeout(o),o=setTimeout(l,e)}return a.clear=function(){clearTimeout(o)},a}function oa(t,e){var o=e.getBoundingClientRect(),a=qe(e),n;if(e.fakeTransform)n=e.fakeTransform;else{var r=a.getComputedStyle(e);n=r.getPropertyValue("-webkit-transform")||r.getPropertyValue("transform")}var s=0,i=0;if(n&&n!=="none"&&typeof n=="string"){var l=n.split("(")[1].split(")")[0].split(",");s=parseInt(l[4],10),i=parseInt(l[5],10)}switch(t){case"left":return"translateX("+(a.innerWidth+s-o.left)+"px)";case"right":return"translateX(-"+(o.left+o.width-s)+"px)";case"up":return"translateY("+(a.innerHeight+i-o.top)+"px)";default:return"translateY(-"+(o.top+o.height-i)+"px)"}}function jt(t,e){if(e){var o=oa(t,e);o&&(e.style.webkitTransform=o,e.style.transform=o)}}var Ue=C.forwardRef(function(t,e){var o=t.children,a=t.direction,n=a===void 0?"down":a,r=t.in,s=t.style,i=t.timeout,l=i===void 0?0:i,c=t.onEnter,u=t.onEntered,p=t.onExit,m=t.onExited,w=kt(t,["children","direction","in","style","timeout","onEnter","onEntered","onExit","onExited"]),v=C.useRef(null),I=ne(o.ref,v),x=ne(I,e),d=function(f,k){jt(n,f),ze(f),c&&c(f,k)},y=function(f){var k=(s==null?void 0:s.transitionTimingFunction)||ae.easeOut,T=Pt({timeout:l,mode:"enter",style:O({},s,{transitionTimingFunction:k})});f.style.webkitTransition=gt("-webkit-transform",T),f.style.transition=gt("transform",T),f.style.webkitTransform="none",f.style.transform="none"},h=function(f){var k=(s==null?void 0:s.transitionTimingFunction)||ae.sharp,T=Pt({timeout:l,mode:"exit",style:O({},s,{transitionTimingFunction:k})});f.style.webkitTransition=gt("-webkit-transform",T),f.style.transition=gt("transform",T),jt(n,f),p&&p(f)},b=function(f){f.style.webkitTransition="",f.style.transition="",m&&m(f)},E=C.useCallback(function(){v.current&&jt(n,v.current)},[n]);return C.useEffect(function(){if(!(r||n==="down"||n==="right")){var _=aa(function(){v.current&&jt(n,v.current)}),f=qe(v.current);return f.addEventListener("resize",_),function(){_.clear(),f.removeEventListener("resize",_)}}},[n,r]),C.useEffect(function(){r||E()},[r,E]),C.createElement(le,Object.assign({appear:!0,nodeRef:v,onEnter:d,onEntered:u,onEntering:y,onExit:h,onExited:b,in:r,timeout:l},w),function(_,f){return C.cloneElement(o,O({ref:x,style:O({visibility:_==="exited"&&!r?"hidden":void 0},s,{},o.props.style)},f))})});Ue.displayName="Slide";var Wt=function(e){return N.createElement("svg",Object.assign({viewBox:"0 0 24 24",focusable:"false",style:{fontSize:20,marginInlineEnd:8,userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0}},e))},ra=function(){return N.createElement(Wt,null,N.createElement("path",{d:`M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41
        10.59L10 14.17L17.59 6.58L19 8L10 17Z`}))},sa=function(){return N.createElement(Wt,null,N.createElement("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"}))},ia=function(){return N.createElement(Wt,null,N.createElement("path",{d:`M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,
        6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,
        13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z`}))},la=function(){return N.createElement(Wt,null,N.createElement("path",{d:`M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,
        0 22,12A10,10 0 0,0 12,2Z`}))},ca={default:void 0,success:N.createElement(ra,null),warning:N.createElement(sa,null),error:N.createElement(ia,null),info:N.createElement(la,null)},st={maxSnack:3,persist:!1,hideIconVariant:!1,disableWindowBlurListener:!1,variant:"default",autoHideDuration:5e3,iconVariant:ca,anchorOrigin:{vertical:"bottom",horizontal:"left"},TransitionComponent:Ue,transitionDuration:{enter:225,exit:195}},ua=function(e,o){var a=function(r){return typeof r=="number"||r===null};return a(e)?e:a(o)?o:st.autoHideDuration},da=function(e,o){var a=function(r,s){return s.some(function(i){return typeof r===i})};return a(e,["string","number"])?e:a(e,["object"])?O({},st.transitionDuration,{},a(o,["object"])&&o,{},e):a(o,["string","number"])?o:a(o,["object"])?O({},st.transitionDuration,{},o):st.transitionDuration},pa=function(e,o){return function(a,n){return n===void 0&&(n=!1),n?O({},st[a],{},o[a],{},e[a]):a==="autoHideDuration"?ua(e.autoHideDuration,o.autoHideDuration):a==="transitionDuration"?da(e.transitionDuration,o.transitionDuration):e[a]||o[a]||st[a]}};function Tt(t){return Object.entries(t).reduce(function(e,o){var a,n=o[0],r=o[1];return O({},e,(a={},a[n]=se(r),a))},{})}var vt={SnackbarContainer:"notistack-SnackbarContainer",Snackbar:"notistack-Snackbar",CollapseWrapper:"notistack-CollapseWrapper",MuiContent:"notistack-MuiContent",MuiContentVariant:function(e){return"notistack-MuiContent-"+e}},ve=Tt({root:{height:0},entered:{height:"auto"}}),zt="0px",qt=175,Ke=C.forwardRef(function(t,e){var o=t.children,a=t.in,n=t.onExited,r=C.useRef(null),s=C.useRef(null),i=ne(e,s),l=function(){return r.current?r.current.clientHeight:0},c=function(I){I.style.height=zt},u=function(I){var x=l(),d=Pt({timeout:qt,mode:"enter"}),y=d.duration,h=d.easing;I.style.transitionDuration=typeof y=="string"?y:y+"ms",I.style.height=x+"px",I.style.transitionTimingFunction=h||""},p=function(I){I.style.height="auto"},m=function(I){I.style.height=l()+"px"},w=function(I){ze(I);var x=Pt({timeout:qt,mode:"exit"}),d=x.duration,y=x.easing;I.style.transitionDuration=typeof d=="string"?d:d+"ms",I.style.height=zt,I.style.transitionTimingFunction=y||""};return C.createElement(le,{in:a,unmountOnExit:!0,onEnter:c,onEntered:p,onEntering:u,onExit:m,onExited:n,onExiting:w,nodeRef:s,timeout:qt},function(v,I){return C.createElement("div",Object.assign({ref:i,className:lt(ve.root,v==="entered"&&ve.entered),style:O({pointerEvents:"all",overflow:"hidden",minHeight:zt,transition:gt("height")},v==="entered"&&{overflow:"visible"},{},v==="exited"&&!a&&{visibility:"hidden"})},I),C.createElement("div",{ref:r,className:vt.CollapseWrapper,style:{display:"flex",width:"100%"}},o))})});Ke.displayName="Collapse";var be={right:"left",left:"right",bottom:"up",top:"down"},fa=function(e){return e.horizontal!=="center"?be[e.horizontal]:be[e.vertical]},ga=function(e){return"anchorOrigin"+ie(e)},ha=function(e){e===void 0&&(e={});var o={containerRoot:!0,containerAnchorOriginTopCenter:!0,containerAnchorOriginBottomCenter:!0,containerAnchorOriginTopRight:!0,containerAnchorOriginBottomRight:!0,containerAnchorOriginTopLeft:!0,containerAnchorOriginBottomLeft:!0};return Object.keys(e).filter(function(a){return!o[a]}).reduce(function(a,n){var r;return O({},a,(r={},r[n]=e[n],r))},{})},ma=function(){};function wt(t,e){return t.reduce(function(o,a){return a==null?o:function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var l=[].concat(s);e&&l.indexOf(e)===-1&&l.push(e),o.apply(this,l),a.apply(this,l)}},ma)}var ya=typeof window<"u"?C.useLayoutEffect:C.useEffect;function xe(t){var e=C.useRef(t);return ya(function(){e.current=t}),C.useCallback(function(){return e.current.apply(void 0,arguments)},[])}var Xe=C.forwardRef(function(t,e){var o=t.children,a=t.className,n=t.autoHideDuration,r=t.disableWindowBlurListener,s=r===void 0?!1:r,i=t.onClose,l=t.id,c=t.open,u=t.SnackbarProps,p=u===void 0?{}:u,m=C.useRef(),w=xe(function(){i&&i.apply(void 0,arguments)}),v=xe(function(h){!i||h==null||(m.current&&clearTimeout(m.current),m.current=setTimeout(function(){w(null,"timeout",l)},h))});C.useEffect(function(){return c&&v(n),function(){m.current&&clearTimeout(m.current)}},[c,n,v]);var I=function(){m.current&&clearTimeout(m.current)},x=C.useCallback(function(){n!=null&&v(n*.5)},[n,v]),d=function(b){p.onMouseEnter&&p.onMouseEnter(b),I()},y=function(b){p.onMouseLeave&&p.onMouseLeave(b),x()};return C.useEffect(function(){if(!s&&c)return window.addEventListener("focus",x),window.addEventListener("blur",I),function(){window.removeEventListener("focus",x),window.removeEventListener("blur",I)}},[s,x,c]),C.createElement("div",Object.assign({ref:e},p,{className:lt(vt.Snackbar,a),onMouseEnter:d,onMouseLeave:y}),o)});Xe.displayName="Snackbar";var Ut,va=Tt({root:(Ut={display:"flex",flexWrap:"wrap",flexGrow:1},Ut[et.upSm]={flexGrow:"initial",minWidth:"288px"},Ut)}),Ge=C.forwardRef(function(t,e){var o=t.className,a=kt(t,["className"]);return N.createElement("div",Object.assign({ref:e,className:lt(va.root,o)},a))});Ge.displayName="SnackbarContent";var Et=Tt({root:{backgroundColor:"#313131",fontSize:"0.875rem",lineHeight:1.43,letterSpacing:"0.01071em",color:"#fff",alignItems:"center",padding:"6px 16px",borderRadius:"4px",boxShadow:"0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12)"},lessPadding:{paddingLeft:8*2.5+"px"},default:{backgroundColor:"#313131"},success:{backgroundColor:"#43a047"},error:{backgroundColor:"#d32f2f"},warning:{backgroundColor:"#ff9800"},info:{backgroundColor:"#2196f3"},message:{display:"flex",alignItems:"center",padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:"16px",marginRight:"-8px"}}),Ee="notistack-snackbar",Ye=C.forwardRef(function(t,e){var o=t.id,a=t.message,n=t.action,r=t.iconVariant,s=t.variant,i=t.hideIconVariant,l=t.style,c=t.className,u=r[s],p=n;return typeof p=="function"&&(p=p(o)),N.createElement(Ge,{ref:e,role:"alert","aria-describedby":Ee,style:l,className:lt(vt.MuiContent,vt.MuiContentVariant(s),Et.root,Et[s],c,!i&&u&&Et.lessPadding)},N.createElement("div",{id:Ee,className:Et.message},i?null:u,a),p&&N.createElement("div",{className:Et.action},p))});Ye.displayName="MaterialDesignContent";var ba=C.memo(Ye),xa=Tt({wrappedRoot:{width:"100%",position:"relative",transform:"translateX(0)",top:0,right:0,bottom:0,left:0,minWidth:"288px"}}),Ea=function(e){var o=C.useRef(),a=C.useState(!0),n=a[0],r=a[1],s=wt([e.snack.onClose,e.onClose]),i=function(){e.snack.requestClose&&s(null,"instructed",e.snack.id)},l=C.useCallback(function(){o.current=setTimeout(function(){r(function(T){return!T})},125)},[]);C.useEffect(function(){return function(){o.current&&clearTimeout(o.current)}},[]);var c=e.snack,u=e.classes,p=e.Component,m=p===void 0?ba:p,w=C.useMemo(function(){return ha(u)},[u]),v=c.open,I=c.SnackbarProps,x=c.TransitionComponent,d=c.TransitionProps,y=c.transitionDuration,h=c.disableWindowBlurListener,b=c.content,E=kt(c,["open","SnackbarProps","TransitionComponent","TransitionProps","transitionDuration","disableWindowBlurListener","content","entered","requestClose","onEnter","onEntered","onExit","onExited"]),_=O({direction:fa(E.anchorOrigin),timeout:y},d),f=b;typeof f=="function"&&(f=f(E.id,E.message));var k=["onEnter","onEntered","onExit","onExited"].reduce(function(T,H){var D;return O({},T,(D={},D[H]=wt([e.snack[H],e[H]],E.id),D))},{});return N.createElement(Ke,{in:n,onExited:k.onExited},N.createElement(Xe,{open:v,id:E.id,disableWindowBlurListener:h,autoHideDuration:E.autoHideDuration,className:lt(xa.wrappedRoot,w.root,w[ga(E.anchorOrigin)]),SnackbarProps:I,onClose:s},N.createElement(x,Object.assign({},_,{appear:!0,in:v,onExit:k.onExit,onExited:l,onEnter:k.onEnter,onEntered:wt([k.onEntered,i],E.id)}),f||N.createElement(m,Object.assign({},E)))))},Ct,Kt,Dt,Lt,Xt,q={view:{default:20},snackbar:{default:6,dense:2}},Ce="."+vt.CollapseWrapper,Gt=16,Mt=Tt({root:(Ct={boxSizing:"border-box",display:"flex",maxHeight:"100%",position:"fixed",zIndex:1400,height:"auto",width:"auto",transition:gt(["top","right","bottom","left","max-width"],{duration:300,easing:"ease"}),pointerEvents:"none"},Ct[Ce]={padding:q.snackbar.default+"px 0px",transition:"padding 300ms ease 0ms"},Ct.maxWidth="calc(100% - "+q.view.default*2+"px)",Ct[et.downXs]={width:"100%",maxWidth:"calc(100% - "+Gt*2+"px)"},Ct),rootDense:(Kt={},Kt[Ce]={padding:q.snackbar.dense+"px 0px"},Kt),top:{top:q.view.default-q.snackbar.default+"px",flexDirection:"column"},bottom:{bottom:q.view.default-q.snackbar.default+"px",flexDirection:"column-reverse"},left:(Dt={left:q.view.default+"px"},Dt[et.upSm]={alignItems:"flex-start"},Dt[et.downXs]={left:Gt+"px"},Dt),right:(Lt={right:q.view.default+"px"},Lt[et.upSm]={alignItems:"flex-end"},Lt[et.downXs]={right:Gt+"px"},Lt),center:(Xt={left:"50%",transform:"translateX(-50%)"},Xt[et.upSm]={alignItems:"center"},Xt)}),Ca=function(e){var o=e.classes,a=o===void 0?{}:o,n=e.anchorOrigin,r=e.dense,s=e.children,i=lt(vt.SnackbarContainer,Mt[n.vertical],Mt[n.horizontal],Mt.root,a.containerRoot,a["containerAnchorOrigin"+ie(n)],r&&Mt.rootDense);return N.createElement("div",{className:i},s)},Ia=C.memo(Ca),Ie=function(e){var o=typeof e=="string"||C.isValidElement(e);return!o},P,Uo=function(t){We(e,t);function e(a){var n;return n=t.call(this,a)||this,n.enqueueSnackbar=function(r,s){if(s===void 0&&(s={}),r==null)throw new Error("enqueueSnackbar called with invalid argument");var i=Ie(r)?r:s,l=Ie(r)?r.message:r,c=i.key,u=i.preventDuplicate,p=kt(i,["key","preventDuplicate"]),m=Ot(c),w=m?c:new Date().getTime()+Math.random(),v=pa(p,n.props),I=O({id:w},p,{message:l,open:!0,entered:!1,requestClose:!1,persist:v("persist"),action:v("action"),content:v("content"),variant:v("variant"),anchorOrigin:v("anchorOrigin"),disableWindowBlurListener:v("disableWindowBlurListener"),autoHideDuration:v("autoHideDuration"),hideIconVariant:v("hideIconVariant"),TransitionComponent:v("TransitionComponent"),transitionDuration:v("transitionDuration"),TransitionProps:v("TransitionProps",!0),iconVariant:v("iconVariant",!0),style:v("style",!0),SnackbarProps:v("SnackbarProps",!0),className:lt(n.props.className,p.className)});return I.persist&&(I.autoHideDuration=void 0),n.setState(function(x){if(u===void 0&&n.props.preventDuplicate||u){var d=function(E){return m?E.id===w:E.message===l},y=x.queue.findIndex(d)>-1,h=x.snacks.findIndex(d)>-1;if(y||h)return x}return n.handleDisplaySnack(O({},x,{queue:[].concat(x.queue,[I])}))}),w},n.handleDisplaySnack=function(r){var s=r.snacks;return s.length>=n.maxSnack?n.handleDismissOldest(r):n.processQueue(r)},n.processQueue=function(r){var s=r.queue,i=r.snacks;return s.length>0?O({},r,{snacks:[].concat(i,[s[0]]),queue:s.slice(1,s.length)}):r},n.handleDismissOldest=function(r){if(r.snacks.some(function(u){return!u.open||u.requestClose}))return r;var s=!1,i=!1,l=r.snacks.reduce(function(u,p){return u+(p.open&&p.persist?1:0)},0);l===n.maxSnack&&(i=!0);var c=r.snacks.map(function(u){return!s&&(!u.persist||i)?(s=!0,u.entered?(u.onClose&&u.onClose(null,"maxsnack",u.id),n.props.onClose&&n.props.onClose(null,"maxsnack",u.id),O({},u,{open:!1})):O({},u,{requestClose:!0})):O({},u)});return O({},r,{snacks:c})},n.handleEnteredSnack=function(r,s,i){if(!Ot(i))throw new Error("handleEnteredSnack Cannot be called with undefined key");n.setState(function(l){var c=l.snacks;return{snacks:c.map(function(u){return u.id===i?O({},u,{entered:!0}):O({},u)})}})},n.handleCloseSnack=function(r,s,i){n.props.onClose&&n.props.onClose(r,s,i);var l=i===void 0;n.setState(function(c){var u=c.snacks,p=c.queue;return{snacks:u.map(function(m){return!l&&m.id!==i?O({},m):m.entered?O({},m,{open:!1}):O({},m,{requestClose:!0})}),queue:p.filter(function(m){return m.id!==i})}})},n.closeSnackbar=function(r){var s=n.state.snacks.find(function(i){return i.id===r});Ot(r)&&s&&s.onClose&&s.onClose(null,"instructed",r),n.handleCloseSnack(null,"instructed",r)},n.handleExitedSnack=function(r,s){if(!Ot(s))throw new Error("handleExitedSnack Cannot be called with undefined key");n.setState(function(i){var l=n.processQueue(O({},i,{snacks:i.snacks.filter(function(c){return c.id!==s})}));return l.queue.length===0?l:n.handleDismissOldest(l)})},P=n.enqueueSnackbar,n.closeSnackbar,n.state={snacks:[],queue:[],contextValue:{enqueueSnackbar:n.enqueueSnackbar.bind(pe(n)),closeSnackbar:n.closeSnackbar.bind(pe(n))}},n}var o=e.prototype;return o.render=function(){var n=this,r=this.state.contextValue,s=this.props,i=s.domRoot,l=s.children,c=s.dense,u=c===void 0?!1:c,p=s.Components,m=p===void 0?{}:p,w=s.classes,v=this.state.snacks.reduce(function(x,d){var y,h=ie(d.anchorOrigin),b=x[h]||[];return O({},x,(y={},y[h]=[].concat(b,[d]),y))},{}),I=Object.keys(v).map(function(x){var d=v[x],y=d[0];return N.createElement(Ia,{key:x,dense:u,anchorOrigin:y.anchorOrigin,classes:w},d.map(function(h){return N.createElement(Ea,{key:h.id,snack:h,classes:w,Component:m[h.variant],onClose:n.handleCloseSnack,onEnter:n.props.onEnter,onExit:n.props.onExit,onExited:wt([n.handleExitedSnack,n.props.onExited],h.id),onEntered:wt([n.handleEnteredSnack,n.props.onEntered],h.id)})}))});return N.createElement(Fe.Provider,{value:r},l,i?sn.createPortal(I,i):I)},Ae(e,[{key:"maxSnack",get:function(){return this.props.maxSnack||st.maxSnack}}]),e}(C.Component),Ko=function(){return C.useContext(Fe)};function _a(){const t=C.useRef({x:0,y:0}),e=je(d=>d.domNode),{getNodes:o,setNodes:a,getEdges:n,setEdges:r,screenToFlowPosition:s}=A(),[i,l]=C.useState([]),[c,u]=C.useState([]);C.useEffect(()=>{if(!e)return;const d=b=>b.preventDefault(),y=b=>{t.current={x:b.clientX,y:b.clientY}},h=["cut","copy","paste"];return h.forEach(b=>e.addEventListener(b,d)),e.addEventListener("mousemove",y),()=>{h.forEach(b=>e.removeEventListener(b,d)),e.removeEventListener("mousemove",y)}},[e]);const p=C.useCallback(()=>{const d=o().filter(b=>b.selected),h=Le(d,n()).filter(b=>{const E=!d.some(f=>f.id===b.source),_=!d.some(f=>f.id===b.target);return!E&&!_});return{selectedNodes:d,selectedEdges:h}},[o,n]),m=C.useCallback(()=>{const{selectedNodes:d,selectedEdges:y}=p();l(d),u(y)},[p]),w=C.useCallback(()=>{try{const{selectedNodes:d,selectedEdges:y}=p();l(d),u(y),a(h=>h.filter(b=>!b.selected)),r(h=>h.filter(b=>!y.includes(b)))}catch(d){P("Ошибка при вырезании",{variant:"error"}),console.error("Paste error:",d)}},[p,a,r]),v=(d,y,h,b)=>{const E=it.getState().getIdNode(),_=y.x+(d.position.x-h),f=y.y+(d.position.y-b);return{...d,id:E,position:{x:_,y:f},data:{...d.data}}},I=d=>{try{const y=it.getState().getIdNode(),h=d.positionAbsoluteX+20,b=(d.height??140)+10,E=d.positionAbsoluteY+b;let _;_={id:y,type:d.type,position:{x:h,y:E},data:{...d.data},selected:!1},a(f=>[...f.map(k=>({...k,selected:!1})),_])}catch(y){P("Ошибка при копировании",{variant:"error"}),console.error("Paste error:",y)}},x=C.useCallback(async(d=s(t.current))=>{if(i.length)try{const y=Math.min(...i.map(f=>f.position.x)),h=Math.min(...i.map(f=>f.position.y)),b=await Promise.all(i.map(f=>v(f,d,y,h))),E=Object.fromEntries(i.map((f,k)=>[f.id,b[k].id])),_=c.map(f=>{var k,T;return{...f,id:ln(),source:E[f.source],sourceHandle:`${E[f.source]} ${(k=f.sourceHandle)==null?void 0:k.split(" ")[1]}`,target:E[f.target],targetHandle:`${E[f.target]} ${(T=f.targetHandle)==null?void 0:T.split(" ")[1]}`}});a(f=>[...f.map(k=>({...k,selected:!1})),...b]),r(f=>[...f.map(k=>({...k,selected:!1})),..._])}catch(y){P("Ошибка при копировании",{variant:"error"}),console.error("Paste error:",y)}},[i,c,s,a,r]);return Yt(["Meta+x","Control+x"],w),Yt(["Meta+c","Control+c"],m),Yt(["Meta+v","Control+v"],x),{cut:w,copy:m,paste:x,bufferedNodes:i,bufferedEdges:c,createDublicate:I}}function Yt(t,e){C.useEffect(()=>{const o=a=>{const n=a.ctrlKey||a.metaKey,r=a.shiftKey;for(const s of t){const i=s.toLowerCase().split("+"),l=i.includes("control")||i.includes("meta"),c=i.includes("shift"),u=i.find(w=>!["control","meta","shift","alt"].includes(w));if(!u)continue;const p=`Key${u.toUpperCase()}`;if(l===n&&c===r&&a.code===p&&!(document.activeElement instanceof HTMLInputElement)&&!(document.activeElement instanceof HTMLTextAreaElement)){a.preventDefault(),e();break}}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,e])}const wa=()=>{const{setNodes:t,setEdges:e}=A();return{handleDelete:(a,n)=>{if(n.type==="discreteInputConnect"||n.type==="discreteOutputConnect"||n.type==="analogInputConnect"||n.type==="analogOutputConnect"||n.type==="analogInputIntConnect"||n.type==="analogOutputIntConnect"){const r=mt.getState().nodes.filter(i=>i.id!==a),s=yt.getState().nodes.filter(i=>i.id!==a);mt.getState().updateNodes(r),yt.getState().updateNodes(s);return}t(r=>r.filter(s=>s.id!==a)),e(r=>r.filter(s=>s.target!==a&&s.source!==a))}}},ka="_row_1sy6z_1",Ta="_input_1sy6z_9",Sa="_outputs_1sy6z_19",Na="_wraps_1sy6z_29",Oa="_text_1sy6z_49",X={row:ka,input:Ta,outputs:Sa,wraps:Na,"handle-wrap":"_handle-wrap_1sy6z_41",text:Oa},Ha="_handle_1orw5_1",ja="_action_1orw5_131",Q={handle:Ha,"handle-wrapper":"_handle-wrapper_1orw5_17","handle-container":"_handle-container_1orw5_29","oscillography-view":"_oscillography-view_1orw5_37","tooltip-visible":"_tooltip-visible_1orw5_93","context-menu":"_context-menu_1orw5_101",action:ja},$t=({id:t,type:e,position:o,dataType:a,data:n})=>{var _;const[r,s]=C.useState(!1),i=C.useRef(null),{updateNodeData:l}=A(),c=cn(),[u,p]=C.useMemo(()=>{const[f="",k=""]=String(t).split(" ");return[f,k]},[t]),m=C.useMemo(()=>c.filter(f=>e==="target"?f.targetHandle===`${t}`:f.sourceHandle===`${t}`),[c,t,e]),w=((_=n==null?void 0:n.outputHandles)==null?void 0:_[p])??{},{oscillography:v=!1,name:I=""}=w,x=f=>{l(u,{...n,outputHandles:{...n.outputHandles,[p]:{...w,...f}}})},d=()=>{x({oscillography:!v})},y=f=>{x({name:f.target.value})},h=f=>{f.stopPropagation(),!(!(n!=null&&n.outputHandles)||Object.keys(n.outputHandles).length===0)&&s(k=>!k)};C.useEffect(()=>{if(!r)return;const f=T=>{i.current&&!i.current.contains(T.target)&&s(!1)},k=T=>{T.key==="Escape"&&s(!1)};return document.addEventListener("click",f),document.addEventListener("touchstart",f),document.addEventListener("keydown",k),()=>{document.removeEventListener("click",f),document.removeEventListener("touchstart",f),document.removeEventListener("keydown",k)}},[r]);const b=f=>{f.stopPropagation(),f.key==="Enter"&&(f.target.blur(),s(!1))},E=C.useMemo(()=>{switch(o){case R.Left:return{transform:"translate(-150%, -50%)"};case R.Right:return{transform:"translate(50%, -50%)"};case R.Top:return{transform:"translate(-50%, -150%)"};case R.Bottom:return{transform:"translate(-50%, 50%)"};default:return{transform:"translate(-50%, -150%)"}}},[o]);return g.jsxs("div",{ref:i,onClick:e==="source"?h:void 0,onDoubleClick:f=>f.stopPropagation(),className:F(Q["handle-wrapper"],"nodrag","nopan"),children:[e==="source"&&r&&g.jsxs("div",{className:Q["context-menu"],role:"menu","aria-label":"Handle context menu",onClick:f=>f.stopPropagation(),children:[g.jsx("label",{children:g.jsx(pt,{type:"text",style:{width:"300px"},value:I,onChange:y,placeholder:"Введите название",onKeyDown:b})}),g.jsx("button",{type:"button",className:Q.action,onClick:d,children:v?"Выключить осциллографирование":"Осциллографировать"})]}),g.jsxs("div",{className:Q["handle-container"],children:[g.jsx(un,{type:e,position:o,id:`${t}`,"data-tooltip":e==="source"?"Нажмите чтобы изменить настройки выхода":void 0,style:{backgroundColor:a?ft[a].clr:"gray",transform:o===R.Left?"translate(-100%, -50%)":o===R.Right?"translate(100%, -50%)":o===R.Top?"translate(-50%, -100%)":"translate(-50%, 100%)"},isConnectable:e==="source"?void 0:m.length<1,className:F(Q.handle,{[Q["tooltip-visible"]]:e==="source"})}),v&&g.jsx("div",{className:Q["oscillography-view"],style:E})]})]})},_e={"handles-column":"_handles-column_gcrpe_1","handle-wrap":"_handle-wrap_gcrpe_11"},Da=({nodeId:t,inputHandles:e,data:o})=>g.jsx("div",{className:_e["handles-column"],children:Object.keys(e).map(a=>g.jsx("div",{className:_e["handle-wrap"],children:g.jsx($t,{id:`${t} ${a}`,type:"target",position:R.Left,dataType:e[a].dataType,data:o})},a))}),La={analogInput:["updateName","updateSetpointValue","delete","dublicate"],analogInputInt:["updateName","updateSetpointValue","delete","dublicate"],discreteInput:["updateName","delete","dublicate"],discreteOutput:["updateName","delete","dublicate"],constInt:["updateSetpointValue","updateName","delete","dublicate"],fourierInt:["updateName","changeFourierGarmonics","delete","dublicate"],xor:["delete","dublicate"],and:["invert","delete","dublicate"],or:["invert","delete","dublicate"],nand:["invert","delete","dublicate"],nor:["invert","delete","dublicate"],multInt:["delete","dublicate"],divInt:["delete","dublicate"],sumInt:["delete","dublicate"],subInt:["delete","dublicate"],timerInt:["updateSetpointValue","updateName","delete","dublicate"],risEdgeTimerBool:["updateDigit","delete","dublicate"],equalsInt:["delete","dublicate"],lessInt:["delete","dublicate"],moreInt:["delete","dublicate"],fifoByte:["updateLengthMemory","delete","dublicate"],fifoByteWithoutEn:["updateLengthMemory","delete","dublicate"],fifoWord:["updateLengthMemory","delete","dublicate"],fifoWordWithoutEn:["updateLengthMemory","delete","dublicate"],rsTrigger:["delete","dublicate"],analogInputConnect:["delete"],analogOutputConnect:["delete"],analogInputIntConnect:["delete"],analogOutputIntConnect:["delete"],discreteInputConnect:["delete"],discreteOutputConnect:["delete"]},Ma=t=>"setpointDataType"in t,Ba={delete:{key:"deleteNode",label:"delete node",dependencies:["useDeleteNode"],createElement:({node:t,dependencies:e})=>{var s;const{id:o,data:a}=t,n=(s=e.useDeleteNode)==null?void 0:s.call(e);if(!n)return null;const{handleDelete:r}=n;return g.jsx(Bt,{text:"Удалить",onClick:()=>r(o,a)})}},dublicate:{key:"dublicate",label:"dublicate node",dependencies:["useCopyPaste"],createElement:({node:t,dependencies:e})=>{var n;const o=(n=e.useCopyPaste)==null?void 0:n.call(e);if(!o)return null;const{createDublicate:a}=o;return g.jsx(Bt,{text:"Дублировать",onClick:()=>a(t)})}},changeFourierGarmonics:{key:"invert",label:"Инвертировать",dependencies:["useUpdateFourierValue"],createElement:({node:t,dependencies:e})=>{const{data:o}=t;if(!("setpointDataType"in o))return;const{outputHandles:a}=o;if(!(e!=null&&e.useUpdateFourierValue))return null;const n=e.useUpdateFourierValue(t.id,t.data);if(!n)return;const{handleFourierGarmonicForOutput:r,inputsValue:s}=n,i=Object.values(a).reduce((l,c,u)=>(u%2===0?l.push([c]):l[l.length-1].push(c),l),[]);return g.jsx("div",{onDoubleClick:l=>{l.stopPropagation()},className:"nodrag nopan nowheel",style:{display:"flex",gap:"10px",width:"max-content"},children:i.map((l,c)=>g.jsx(pt,{style:{width:"60px"},type:"number",min:0,value:s[c],onChange:u=>r(c,u.target.value)},c))})}},invert:{key:"invert",label:"Инвертировать",dependencies:["useInverseNode"],createElement:({node:t,dependencies:e})=>{var r;const{id:o,data:a}=t,n=(r=e.useInverseNode)==null?void 0:r.call(e,o,a.type);return g.jsx(Bt,{onClick:n,text:"Инвертировать",type:"button"})}},updateSetpointValue:{key:"updateSetpointValue",label:"Изменить значение",dependencies:["useUpdateSetpointValue"],createElement:({node:t,dependencies:e})=>{var s;const{data:o}=t;if(!Ma(o))return null;const a=(s=e.useUpdateSetpointValue)==null?void 0:s.call(e,t.id,o);if(!a)return null;const{handleChange:n,inputValue:r}=a;return g.jsx("div",{className:"flex flex-col gap-2",children:g.jsx(pt,{type:"text",value:r,onChange:n,placeholder:"Введите значение"})})}},updateName:{key:"updateName",label:"Изменить значение",dependencies:["useUpdateNameValue"],createElement:({node:t,dependencies:e})=>{var i;const{id:o,data:a}=t,n=(i=e.useUpdateNameValue)==null?void 0:i.call(e,o,a);if(!n)return null;const{name:r,handleChangeName:s}=n;return g.jsx("div",{className:"flex flex-col gap-2",children:g.jsx(pt,{type:"text",value:r,onChange:s,placeholder:"Введите имя"})})}},updateDigit:{key:"updateDigit",label:"Изменить значение",dependencies:["useUpdateDigit"],createElement:({node:t,dependencies:e})=>{var i;const{id:o,data:a}=t,n=(i=e.useUpdateDigit)==null?void 0:i.call(e,o,a);if(!n)return null;const{digit:r,handleChangeDigit:s}=n;return g.jsx("div",{className:"nodrag nopan nowheel",onDoubleClick:l=>{l.stopPropagation()},children:g.jsx(pt,{type:"number",min:0,max:6e3,value:r,onChange:s,placeholder:"Введите значение"})})}},updateLengthMemory:{key:"updateLengthMemory",label:"Изменить значение",dependencies:["useChangeLengthMemory"],createElement:({node:t,dependencies:e})=>{var i;const{id:o,data:a}=t,n=(i=e.useChangeLengthMemory)==null?void 0:i.call(e,o,a);if(!n)return null;const{lengthMemory:r,handleChangeLengthMemory:s}=n;return g.jsx("div",{className:"nodrag nopan nowheel",onDoubleClick:l=>{l.stopPropagation()},children:g.jsx(pt,{type:"number",min:1,value:r,onChange:s,placeholder:"Введите глубину"})})}}},$a=t=>Object.values({0:"1",1:"2",2:"3",3:"4",4:"5",5:"6",6:"7",7:"8"}).slice(0,t).reduce((o,a)=>(o[a]=void 0,o),{}),Va=t=>{const{updateNodeData:e,getEdges:o,setEdges:a,getNode:n}=A(),r=oe(),s=[...new Array(10)].reduce((l,c,u)=>(l.push({value:u+1}),l),[]);return{changeHandles:C.useCallback(l=>{e(t,{inputHandlesCount:l}),r(t);const c=o(),u=Object.keys($a(+l)).map(m=>`${t} ${m}`),p=c.filter(m=>m.target!==t||m.targetHandle&&u.includes(m.targetHandle));a(p)},[t,e,r,o,a,n]),items:s}},Ra={or:"nor",and:"nand",nor:"or",nand:"and"},Pa=(t,e)=>{const{updateNodeData:o}=A();return C.useCallback(()=>{o(t,{type:Ra[e]})},[t,e,o])};function Aa(t){const e=new Uint8Array(4);return e[3]=t>>24&255,e[2]=t>>16&255,e[1]=t>>8&255,e[0]=t&255,e}const Wa=(t,e)=>{const{updateNodeData:o}=A();if(!("setpointDataType"in e)||e.type!=="fourierInt")return;const[a,n]=C.useState([...e.setpointValue]);return{inputsValue:a,handleFourierGarmonicForOutput:(s,i)=>{if(Me(i)){const l=Number(i);if(!Number.isNaN(l)&&l>=0&&l<=19){const c=[...a];c[s]=l,o(t,{setpointValue:[...c]}),n([...c])}}}}},Fa=(t,e)=>{const{updateNodeData:o}=A();if(!("setpointDataType"in e)||Array.isArray(e.setpointValue))return;const{setpointDataType:a}=e,[n,r]=C.useState(String(e.setpointValue)),s=(l,c)=>{if(l===""||l==="-"||l==="."||l==="-.")return l;c&&(l=l.replace(",","."));const u=Number(l);return Number.isNaN(u)?l:String(u)};return{handleChange:l=>{let c=l.target.value;switch(a){case"int":if(Me(c)){const m=s(c,!1);r(m);const w=Number(m);Number.isNaN(w)||o(t,{setpointValue:w})}break;case"float":if(Sn(c)){const m=s(c,!0);r(m);const w=Number(m);Number.isNaN(w)||o(t,{setpointValue:w})}break;case"bool":const p=l.target.checked?1:0;o(t,{setpointValue:p}),r(String(p));break}},inputValue:n}},za=(t,e)=>{const{updateNodeData:o}=A(),a=n=>{const r=n.target.value;o(t,{name:r})};return{name:e.name,handleChangeName:a}},qa=(t,e)=>{if(!("lengthMemory"in e))return null;const{updateNodeData:o}=A(),a=n=>{const r=n.target.value;o(t,{lengthMemory:+r})};return{lengthMemory:e.lengthMemory,handleChangeLengthMemory:a}},Ua=(t,e)=>{const{updateNodeData:o}=A();if(!("digit"in e))return;const a=n=>{const r=Number(n.target.value);r&&o(t,{digit:r})};return{digit:e.digit,handleChangeDigit:a}},Ka=t=>{var n;const{type:e}=t.data,o={useChangeHandles:Va,useInverseNode:Pa,useUpdateSetpointValue:Fa,useUpdateNameValue:za,useDeleteNode:wa,useUpdateFourierValue:Wa,useCopyPaste:_a,useChangeLengthMemory:qa,useUpdateDigit:Ua};return{actions:(n=La[e])==null?void 0:n.map(r=>{const s=Ba[r];if(!s)return null;const i=s.dependencies.reduce((l,c)=>(c in o&&(l[c]=o[c]),l),{});return{key:s.key,label:s.label,element:s.createElement({node:t,dependencies:i})}})}},we={"context-menu-block":"_context-menu-block_64p36_1","menu-item":"_menu-item_64p36_15"},Xa=C.memo(({actions:t,visible:e,setVisible:o})=>{const a=C.useRef(null);return C.useEffect(()=>{const n=r=>{a.current&&!a.current.contains(r.target)&&o(!1)};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[]),g.jsx(dn,{isVisible:e,children:g.jsx("div",{ref:a,className:we["context-menu-block"],children:t.map((n,r)=>g.jsx("div",{className:we["menu-item"],children:n.element},r))})})}),S=({node:t,children:e})=>{const[o,a]=C.useState(!1),{actions:n}=Ka(t);return g.jsxs("div",{style:{position:"relative"},onDoubleClick:()=>a(r=>!r),children:[e,g.jsx(Xa,{actions:n,visible:o,setVisible:a})]})},Ga="_inc_1tbfq_1",Ya="_dec_1tbfq_9",Za="_disabled_1tbfq_47",It={"inc-dec":"_inc-dec_1tbfq_1",inc:Ga,dec:Ya,disabled:Za},G=({node:t,children:e})=>{const{id:o,data:a}=t,{updateNodeData:n,setEdges:r}=A(),s=oe(),i=a.inputHandles||{},l=Object.keys(i),c=i[l[0]].dataType,u={min:2,max:10},p=()=>{const I=l.length;if(I>=u.max)return;const x=`input-${I+1}`,d={...i,[x]:{dataType:c}};n(o,{inputHandles:d}),s(o)},m=()=>{if(l.length<=u.min)return;const d=Object.keys(i).filter(b=>b.startsWith("input-")).sort((b,E)=>{const _=parseInt(b.replace("input-",""),10);return parseInt(E.replace("input-",""),10)-_})[0],{[d]:y,...h}=i;r(b=>b.filter(E=>E.targetHandle!==`${o} ${d}`)),n(o,{inputHandles:h}),s(o)},w=l.length>=u.max,v=l.length<=u.min;return g.jsxs("div",{className:It["inc-dec"],children:[g.jsx("button",{className:F(It.inc,"nodrag",{[It.disabled]:w}),onClick:p,disabled:w,children:"+"}),e,g.jsx("button",{className:F(It.dec,"nodrag",{[It.disabled]:v}),onClick:m,disabled:v,children:"—"})]})},Ja="_btn_aosl1_9",Qa="_inc_aosl1_1",to="_disabled_aosl1_41",eo="_dec_aosl1_47",Y={"inc-dec":"_inc-dec_aosl1_1","btns-row":"_btns-row_aosl1_9",btn:Ja,inc:Qa,disabled:to,dec:eo},no=({node:t,children:e})=>{const{id:o,data:a}=t,{updateNodeData:n,setEdges:r}=A(),s=a.outputHandles||{},i=Object.keys(s),l={min:2,max:6},c=oe(),u=()=>{const v=i.length,I=l.max-v,x=Math.min(2,I);if(x>0){const d={...s};for(let y=1;y<=x;y++){const h=`out-${v+y}`;d[h]={dataType:"int"}}n(o,{outputHandles:d}),c(o)}},p=()=>{const I=i.length-l.min,x=Math.min(2,I);if(x>0){const d={...s},y=Object.keys(d).filter(h=>h.startsWith("out-")).sort((h,b)=>{const E=parseInt(h.replace("out-",""),10);return parseInt(b.replace("out-",""),10)-E});for(let h=0;h<x;h++){const b=y[h];r(E=>E.filter(_=>_.sourceHandle!==`${o} ${b}`)),delete d[b]}n(o,{outputHandles:d}),c(o)}},m=i.length>=l.max,w=i.length<=l.min;return g.jsxs("div",{className:Y["inc-dec"],children:[e,g.jsxs("div",{className:Y["btns-row"],children:[g.jsx("button",{className:F(Y.btn,Y.inc,"nodrag",{[Y.disabled]:m}),onClick:u,disabled:m,children:"+"}),g.jsx("button",{className:F(Y.btn,Y.dec,"nodrag",{[Y.disabled]:w}),onClick:p,disabled:w,children:"—"})]})]})},ao={analogInput:[S],analogInputInt:[S],discreteInput:[S],discreteOutput:[S],fourierInt:[S,no],constInt:[S],xor:[S,G],and:[S,G],or:[S,G],nand:[S,G],nor:[S,G],multInt:[S,G],divInt:[S,G],sumInt:[S,G],subInt:[S],timerInt:[S],risEdgeTimerBool:[S],equalsInt:[S],lessInt:[S],moreInt:[S],fifoByte:[S],fifoByteWithoutEn:[S],fifoWord:[S],fifoWordWithoutEn:[S],rsTrigger:[S],analogInputConnect:[S],analogOutputConnect:[S],analogInputIntConnect:[S],analogOutputIntConnect:[S],discreteInputConnect:[S],discreteOutputConnect:[S]},oo=(t,e)=>(ao[t.data.type]||[]).reduce((a,n,r)=>g.jsx(n,{node:t,children:a},`feature-${r}`),e),ro=C.memo(t=>{const{type:e,inputHandles:o,outputHandles:a}=t.data,n=pn[e];if(!n)return null;const{view:r,...s}=n,i=g.jsxs("div",{className:X.row,children:[!!Object.keys(o).length&&g.jsx(Da,{nodeId:t.id,inputHandles:o,data:t.data}),g.jsx(r,{...s}),!!Object.keys(a).length&&Object.keys(a).map(u=>g.jsx($t,{id:`${t.id} ${u}`,type:"source",position:R.Right,dataType:a[u].dataType,data:t.data},u))]}),c=e!=="fourierInt"?i:(()=>{const u=Object.keys(o).length,p=Object.keys(o)[0];return g.jsxs("div",{className:X.row,children:[!!u&&g.jsx("div",{className:X.input,children:g.jsx($t,{id:`${t.id} ${p}`,type:"target",position:R.Left,dataType:o[p].dataType,data:t.data},p)}),g.jsx(r,{...s}),!!Object.keys(a).length&&g.jsx("div",{className:X.outputs,children:Array.from({length:Math.ceil(Object.keys(a).length/2)},(m,w)=>Object.keys(a).slice(w*2,w*2+2)).map((m,w)=>g.jsx("div",{className:X.wraps,children:m.map((v,I)=>g.jsxs("div",{className:X["handle-wrap"],children:[I===0?g.jsx("div",{className:X.text,children:"Amp"}):g.jsx("div",{className:X.text,children:"Ph"}),g.jsx($t,{id:`${t.id} ${v}`,type:"source",position:R.Right,dataType:a[v].dataType,data:t.data},`${w}-${I}`)]},v))},w))})]})})();return oo(t,c)}),Xo={account:"paid-pro",hideAttribution:!0};fn.SmoothStep;const Go={node:ro},Yo={"custom-edge":Xn},Zo=({fromX:t,fromY:e,toX:o,toY:a,fromPosition:n,fromHandle:r,toPosition:s,fromNode:i})=>{var u,p,m,w;const[l]=De({sourceX:t,sourceY:e,targetX:o,targetY:a,offset:15,sourcePosition:n,targetPosition:s});if(!i||!r||!r.id)return null;const c=((p=i.data.outputHandles[(u=r.id)==null?void 0:u.split(" ")[1]])==null?void 0:p.dataType)||((w=i.data.inputHandles[(m=r.id)==null?void 0:m.split(" ")[1]])==null?void 0:w.dataType);return c?g.jsx("g",{children:g.jsx("path",{fill:"none",stroke:ft[c].clr,strokeWidth:3,d:l})}):null},so="_panel__item_1tehr_15",io="_name_1tehr_41",Zt={"sidebar-item-drag-image":"_sidebar-item-drag-image_1tehr_1",panel__item:so,name:io},lo=({viewData:t,type:e})=>{const o=C.useRef(null),{view:a,name:n,...r}=t,s=i=>{var l;(l=i.dataTransfer)==null||l.setData("application/reactflow",e),o.current&&i.dataTransfer.setDragImage(o.current,0,0)};return g.jsxs("div",{className:Zt.panel__item,draggable:!0,onDragStart:s,children:[g.jsx(a,{...t}),g.jsx("div",{className:Zt.name,children:n}),g.jsx("div",{className:Zt["sidebar-item-drag-image"],ref:o,children:g.jsx(a,{...r})})]})},co="_elements_15sbx_1",uo={elements:co},Z=({views:t})=>g.jsx("div",{className:uo.elements,children:Object.entries(t).map(e=>g.jsx(lo,{viewData:e[1],type:e[0]},e[0]))}),Jo=()=>g.jsx("div",{children:g.jsxs(Vn,{text:"Библиотека",position:"right",children:[g.jsx(K,{name:"Входы и выходы",children:g.jsx(Z,{views:{...Object.fromEntries(Object.entries(hn).filter(([t,e])=>t!=="discreteInputConnect"&&t!=="analogInputConnect"&&t!=="analogInputIntConnect")),...gn}})}),g.jsx(K,{name:"Логические элементы",children:g.jsx(Z,{views:mn})}),g.jsx(K,{name:"Алгебраические операции",children:g.jsx(Z,{views:yn})}),g.jsx(K,{name:"Операции сравнения",children:g.jsx(Z,{views:vn})}),g.jsx(K,{name:"Выдержки времени",children:g.jsx(Z,{views:bn})}),g.jsx(K,{name:"Фурье",children:g.jsx(Z,{views:xn})}),g.jsx(K,{name:"Fifo",children:g.jsx(Z,{views:En})}),g.jsx(K,{name:"Триггеры",children:g.jsx(Z,{views:Cn})})]})});function ht(t){return{id:t.id,source:t.s,sourceHandle:t.sh,target:t.t,targetHandle:t.th,type:"custom-edge",animated:!1}}function At(t){const e={id:t.id,type:"node",position:{x:t.p[0],y:t.p[1]},data:{type:t.t,inputHandles:{},outputHandles:{}}};if(t.nm&&(e.data.name=t.nm),t.i&&(e.data.inputHandles=Object.fromEntries(Object.entries(t.i).map(([o,a])=>[o,{dataType:a}]))),t.o){const o={};for(const[a,n]of Object.entries(t.o))typeof n=="string"?o[a]={dataType:n}:(o[a]={dataType:n.dataType},n.name&&(o[a].name=n.name),n.oscillography&&(o[a].oscillography=n.oscillography));e.data.outputHandles=o}return t.d!==void 0&&t.v!==void 0&&(e.data.setpointDataType=t.d,e.data.setpointValue=t.v),t.m!==void 0&&(e.data.lengthMemory=t.m),t.g!==void 0&&(e.data.digit=t.g),e}function ke(t){return{id:t.id,s:t.source,sh:t.sourceHandle,t:t.target,th:t.targetHandle}}function Te(t){const{id:e,position:o,data:a}=t,n={id:e,p:[Math.floor(o.x),Math.floor(o.y)],t:a.type};if(a.name&&(n.nm=a.name),a.inputHandles&&(n.i=Object.fromEntries(Object.entries(a.inputHandles).map(([r,s])=>[r,s.dataType]))),a.outputHandles){const r={};for(const[s,i]of Object.entries(a.outputHandles))r[s]={dataType:i.dataType},i.name&&(r[s].name=i.name),i.oscillography&&(r[s].oscillography=i.oscillography);n.o=r}return"setpointValue"in a&&(n.v=a.setpointValue,n.d=a.setpointDataType),"lengthMemory"in a&&(n.m=a.lengthMemory),"digit"in a&&(n.g=a.digit),n}const Jt=U({characteristic:Nn(["U","I","HRM3"]),k:W(),offset:W()}),po=U({U:Jt,I:Jt,HRM3:Jt}),fo=U({dataType:V(),name:V().optional(),oscillography:On().optional()}),Se=U({id:V(),p:Hn([W(),W()]),t:V(),i:ue(V()).optional(),o:ue(fo).optional(),v:Ve().optional(),d:V().optional(),m:W().optional(),g:W().optional(),n:W().optional()}),Ne=U({id:V(),s:V(),sh:V().optional(),t:V(),th:V().optional()});U({logic1:U({nodes:$(Se),edges:$(Ne)}),logic2:U({nodes:$(Se),edges:$(Ne)})});const go=U({scripts_250us:$($(W())),scripts_1ms:$($(W())),functions:$(W()),setpoints:$(W()),flexLogic:V(),outputMatrix:$($(ce([Nt(0),Nt(1)]))),inputMatrix:$($(ce([Nt(0),Nt(1)]))),sms:V(),smsWeb:V(),phoneNumber:V(),offsetsOsc:$(Ve()),characteristics:po});function Ze(t){try{const e=JSON.parse(new TextDecoder().decode(t));return go.parse(e)}catch(e){return console.error("Конфигурация не прошла проверку:",e),null}}const Je=(t,e,o)=>{const a=[...e,...o].filter(r=>{var s,i,l,c,u;return((i=(s=r==null?void 0:r.data)==null?void 0:s.type)==null?void 0:i.toLowerCase().includes("output"))&&((l=r==null?void 0:r.data)==null?void 0:l.type)!=="discreteOutputConnect"&&((c=r==null?void 0:r.data)==null?void 0:c.type)!=="analogOutputConnect"&&((u=r==null?void 0:r.data)==null?void 0:u.type)!=="analogOutputIntConnect"}),n={};a.forEach((r,s)=>{const i=t[s]??[];n[r.id]={id:r.id,name:r.data.name??"",led1:i[0]??0,led2:i[1]??0,led3:i[2]??0,blOn:i[3]??0,blOff:i[4]??0,sms:i[5]??0,smsWeb:i[6]??0}}),$e.getState().setIndications(n)};function Qe(t){const{setCharacteristicTypeData:e}=Vt.getState();e("U","k",t.U.k),e("I","k",t.I.k),e("HRM3","k",t.HRM3.k)}function tn(t,e,o){const{setDatas:a}=Vt.getState(),r=[...e,...o].filter(s=>{var i,l,c,u,p;return((l=(i=s==null?void 0:s.data)==null?void 0:i.type)==null?void 0:l.toLowerCase().includes("input"))&&((c=s==null?void 0:s.data)==null?void 0:c.type)!=="discreteInputConnect"&&((u=s==null?void 0:s.data)==null?void 0:u.type)!=="analogInputConnect"&&((p=s==null?void 0:s.data)==null?void 0:p.type)!=="analogInputIntConnect"}).reduce((s,i,l)=>{var u;const c=t[l]??[0,0,0];return s[i.id]={id:i.id,name:((u=i.data)==null?void 0:u.name)??"",I:c[0]??0,U:c[1]??0,HRM3:c[2]??0},s},{});a(r)}function Oe(t){return t.map(e=>{const o="digit"in e?[e.inType,e.instructionOffset,...e.resultOffsets,...e.sourcesOffsets,e.digit,e.workingSpace]:"lengthMemory"in e?[e.inType,e.instructionOffset,e.ptrBegin,e.lengthMemory,...e.resultOffsets,...e.sourcesOffsets,e.workingSpace]:"instructionOffset"in e?[e.inType,e.instructionOffset,...e.resultOffsets,...e.sourcesOffsets]:[e.inType,...e.sourcesOffsets,...e.resultOffsets];for(;o.length<10;)o.push(0);return o})}function ho({flexLogic:t,scripts_1ms:e,scripts_250us:o,instructions:a,setpoints:n,indications:r,inputMatrixData:s,offsetsOsc:i,sms:l,smsWeb:c,phoneNumber:u,characteristics:p}){const m=Oe(e),w=Oe(o),v=Object.values(r).map(({led1:d,led2:y,led3:h,blOn:b,blOff:E,sms:_,smsWeb:f})=>[d,y,h,b,E,_,f]),I=Object.values(s).map(({I:d,U:y,HRM3:h})=>[d,y,h]);let x=[];return Object.entries(i).forEach(d=>{x.push({length:d[1].lengthMemory,offset:Number(d[0])})}),{flexLogic:t,scripts_1ms:m,scripts_250us:w,functions:a,setpoints:n,outputMatrix:v,inputMatrix:I,sms:l,smsWeb:c,phoneNumber:u,offsetsOsc:x,characteristics:p}}const mo=(t,e,o)=>{if(!e.length)return{newPrimitiveData:{lengthInBytes:t.lengthInBytes,offset:1},newOffset:1,lastLength:t.lengthInBytes};const a=e.slice(-1)[0]+o,n={lengthInBytes:t.lengthInBytes,offset:a};return{newOffset:a,newPrimitiveData:n,lastLength:t.lengthInBytes}},yo=()=>({lastLength:0,instructions:[],offsets:[],primitivesData:{}}),at={bool:1,int:4,float:4,analog:160},vo=(t,e,o)=>{var r;const a=t.data.type;if(_n(rt).includes(a)&&!((r=o.primitivesData[a])!=null&&r[e])){const s=rt[a];if(s&&s[e]){o.instructions.push(...s[e].instruction);const{newOffset:i,newPrimitiveData:l,lastLength:c}=mo(rt[a][e],o.offsets,o.lastLength);o.primitivesData[a]={...o.primitivesData[a],[e]:l},o.offsets.push(i),o.lastLength=c}}},bo=(t,e)=>{try{const o=Object.keys(e.data.inputHandles);if(o.length===0)return!0;for(const a of o)if(!t.find(r=>r.targetHandle===`${e.id} ${a}`))throw new Error(`Не найдено исходное смещение для handle ${a} узла ${e.id}`)}catch(o){throw new Error(`Ошибка при создании scriptItem для узла ${e.id}: ${o instanceof Error?o.message:String(o)}`)}},xo=(t,e,o,a,n,r,s,i)=>{var l,c,u,p,m,w,v,I,x,d,y,h,b,E;try{const{initOscillographicOffsets:_}=te.getState(),f=t.data.type;if(f==="discreteOutputConnect"||f==="analogOutputConnect"||f==="analogOutputIntConnect")return;const k=f,T=Object.keys(t.data.inputHandles).length;let H;k.includes("Output")?H=[s.get(t.id)]:(H=Object.entries(t.data.outputHandles).map(([L])=>r.get(`${t.id} ${L}`)),Object.entries(t.data.outputHandles).forEach(([L,j])=>{const M=r.get(`${t.id} ${L}`);if(M===void 0)throw new Error(`Не найдено смещение в мапе для handle ${L} узла ${t.id}`);j.oscillography&&_(M,j.name??"",at[j.dataType],j.dataType,j.dataType==="bool"?"line":"block")}));let D=Object.keys(t.data.inputHandles).reduce((L,j)=>{var St;const M=(St=e.find(nn=>`${t.id} ${j}`===nn.targetHandle))==null?void 0:St.sourceHandle;if(!M)throw new Error(`Не найдено исходный handle для handle ${j} узла ${t.id}`);const B=r.get(M);if(B===void 0)throw new Error(`Не найдено исходный узел для handle ${j} узла ${t.id}`);return L.push(B),L},[]);if(t.data.type.includes("analogInput")&&(D=[i.analog.splice(0,at.analog)[0]]),"setpointDataType"in t.data){const{setpointsValues:L,setSetpoints:j}=Be.getState(),M=[...L],B=n[t.data.setpointDataType].splice(0,t.data.setpointDataType==="bool"?1:4)[0];if(t.data.type==="fourierInt")Array.isArray(t.data.setpointValue)&&(M.splice(B,4,...t.data.setpointValue),j([...M]),D.unshift(B));else if(!Array.isArray(t.data.setpointValue))if(t.data.setpointDataType==="bool")M[B]=t.data.setpointValue,j([...M]),D.push(B);else{const St=Aa(t.data.setpointValue);M.splice(B,4,...St),j([...M]),D.push(B)}}if(k==="fourierInt")return{inType:(c=(l=rt[k])==null?void 0:l[T])==null?void 0:c.in_type,sourcesOffsets:D,resultOffsets:H};if("digit"in t.data)return{inType:(p=(u=rt[k])==null?void 0:u[T])==null?void 0:p.in_type,instructionOffset:(w=(m=o.primitivesData[k])==null?void 0:m[T])==null?void 0:w.offset,resultOffsets:H,sourcesOffsets:D,digit:t.data.digit,workingSpace:a.int.splice(0,at.int)[0]};if("lengthMemory"in t.data){const L=Object.values(t.data.outputHandles)[0].dataType,j=t.data.lengthMemory,M=a[L].splice(0,j*at[L])[0],B=a.int.splice(0,at.int)[0];return{inType:(I=(v=rt[k])==null?void 0:v[T])==null?void 0:I.in_type,instructionOffset:(d=(x=o.primitivesData[k])==null?void 0:x[T])==null?void 0:d.offset,ptrBegin:M,lengthMemory:j,resultOffsets:H,sourcesOffsets:D,workingSpace:B}}return{inType:(h=(y=rt[k])==null?void 0:y[T])==null?void 0:h.in_type,instructionOffset:(E=(b=o.primitivesData[k])==null?void 0:b[T])==null?void 0:E.offset,resultOffsets:H,sourcesOffsets:D}}catch(_){throw new Error(`Ошибка при создании scriptItem для узла ${t.id}: ${_ instanceof Error?_.message:String(_)}`)}};function en(t,e,o,a,n,r,s,i,l,c,u){var I,x,d;if(e.has(t.id)||(e.add(t.id),t.data.type==="discreteInputConnect"||t.data.type==="analogInputConnect"||t.data.type==="analogInputIntConnect"))return;t.data.type!=="fourierInt"&&((I=t.data)==null?void 0:I.type)!=="discreteOutputConnect"&&((x=t.data)==null?void 0:x.type)!=="analogOutputConnect"&&((d=t.data)==null?void 0:d.type)!=="analogOutputIntConnect"&&vo(t,Object.keys(t.data.inputHandles).length,a);const p=Le([t],u),{targets:m}=p.reduce((y,h)=>(h.source===t.id&&y.sources.push(h),h.target===t.id&&y.targets.push(h),y),{sources:[],targets:[]});bo(m,t);const w=In(t,c,u),v=xo(t,m,a,n,s,r,i,l);w.forEach(y=>en(y,e,o,a,n,r,s,i,l,c,u)),v&&o.push(v)}const Eo=(t,e,o,a)=>{const n=new Map,r=new Map;for(let s of t){const i=s.data.type;if(!(i==="discreteInputConnect"||i==="analogInputConnect"||i==="analogInputIntConnect")){if(i.toLocaleLowerCase().includes("out")&&i!=="discreteOutputConnect"&&i!=="analogOutputConnect"&&i!=="analogOutputIntConnect"){const l=Object.values(s.data.inputHandles)[0].dataType,c=a[l].shift();r.set(s.id,c)}if(i==="discreteOutputConnect"||i==="analogOutputConnect"||i==="analogOutputIntConnect"){const l=e.find(p=>p.target===s.id);if(!l)throw new Error(`Для outputConnect узла ${s.id} не найден входящий edge`);if(!l.sourceHandle)throw new Error(`Для outputConnect узла ${s.id} не найден входящий edge`);const c=t.find(p=>p.id===l.source);if(!c)throw new Error(`Не найден узел-источник ${l.source} для ${s.id}`);let u=n.get(l.sourceHandle);if(u===void 0){const p=Object.values(c.data.outputHandles)[0].dataType,m=o[p].splice(0,at[p])[0];n.set(l.sourceHandle,m),u=m}n.set(`${s.id} out`,u)}Object.entries(s.data.outputHandles).forEach(([l,c])=>{const u=Object.values(s.data.outputHandles)[0].dataType,p=o[u].splice(0,at[u])[0];n.get(`${s.id} ${l}`)||n.set(`${s.id} ${l}`,p)})}}return{handleOffsetsMap:n,outputOffsetsMap:r}},_t=["bool","int","float","analog"],Qt=(t,e)=>e===1?t:Math.ceil(t/4)*4,Co=(t,e)=>{const o=[];for(let a=t;a<t+e;a++)o.push(a);return o},Io=(t,e,o,a)=>t<=a&&o<=e,_o=(t,e)=>t.map(o=>o+e),tt=(t,e,o,a={bool:1,int:4,float:4,analog:160})=>{const n=a[t],r=_t.indexOf(t),s=c=>e[c].length?e[c][e[c].length-1]:null;let i=e[t].length?e[t][e[t].length-1]+1:0;if(e[t].length===0){for(let c=0;c<r;c++){const u=_t[c],p=s(u);p!==null&&(i=Math.max(i,Qt(p+1,n)))}i=Qt(i,n)}e[t].push(...Co(i,o??n));const l=c=>{const u=_t[c],p=e[u];if(!p.length)return;const m=p[0],w=p[p.length-1];for(let v=c+1;v<_t.length;v++){const I=_t[v],x=e[I];if(!x.length)continue;const d=x[0],y=x[x.length-1];if(Io(m,w,d,y)){const h=a[I],E=Qt(w+1,h)-d;e[I]=_o(x,E),l(v);return}}};l(r)},wo={bool:1,int:4,float:4,analog:160};function ko(t,e=512){const a=new TextEncoder().encode(t),n=[];let r=0;for(;r<a.length;){const s=a.slice(r,r+e),i=new TextDecoder().decode(s);n.push(i),r+=e}return n}const Qo=()=>{const[t,e,o]=mt(d=>[d.nodes,d.edges,d.resetDirty],ot),[a,n,r]=yt(d=>[d.nodes,d.edges,d.resetDirty],ot),[s,i]=wn(d=>[d.sendConfig,d.addLog]),[l,c,u,p]=$e(d=>[d.indications,d.smsText,d.smsWebText,d.phoneNumber],ot),[m]=Vt(d=>[d.datas,d.characteristicTypeData],ot),w=d=>{const y={bool:[],int:[],float:[],analog:[]},h={bool:[],int:[],float:[],analog:[]},b={bool:[],int:[],float:[],analog:[]},E={bool:[],int:[],float:[],analog:[]};return d.forEach(_=>{Object.values(_.data.outputHandles).forEach(f=>{if(tt(f.dataType,y),_.data.type.toLocaleLowerCase().includes("fifo")&&"lengthMemory"in _.data){const k=_.data.lengthMemory,T=Object.values(_.data.outputHandles)[0].dataType,H=k*wo[T];tt(f.dataType,y,H),tt("int",y)}}),"setpointDataType"in _.data&&tt(_.data.setpointDataType,h,void 0,{bool:1,int:4,float:4,analog:4}),_.data.type==="risEdgeTimerBool"&&tt("int",y),_.data.type.includes("analogInput")&&tt("analog",E,void 0,{bool:1,int:4,float:4,analog:160}),_.data.type.toLocaleLowerCase().includes("output")&&tt(_.data.inputHandles.input.dataType,b)}),{offsets:{bool:[...y.bool],int:[...y.int],float:[...y.float],analog:[...y.analog]},setpointOffsets:{bool:[...h.bool],int:[...h.int],float:[...h.float],analog:[...h.analog]},outputOffsetsStore:{bool:[...b.bool],int:[...b.int],float:[...b.float],analog:[...b.analog]},analogInputsOffsets:{bool:[...E.bool],int:[...E.int],float:[...E.float],analog:[...E.analog]}}},v=(d,y,h,b,E,_,f,k,T)=>{const H=[],D=new Set,L=d.filter(j=>{var M;return(M=j.data)==null?void 0:M.type.toLowerCase().includes("output")});return L.length?(L.forEach(j=>en(j,D,H,f,h,k,b,T,_,d,y)),{scripts:H,instructions:f.instructions}):(console.warn("Нет выходных элементов в этом редакторе"),{scripts:[],instructions:f.instructions})};return{calculateConfig:async()=>{try{const{setConfig:d}=ee.getState(),y=[...t,...a];console.log("Рассчет конфигурации:"),console.log(`  - Редактор 1: ${t.length} нод`),console.log(`  - Редактор 2: ${a.length} нод`);const{offsets:h,setpointOffsets:b,outputOffsetsStore:E,analogInputsOffsets:_}=w(y);te.getState().clearOscillographicOffsets();const f=yo(),{handleOffsetsMap:k,outputOffsetsMap:T}=Eo([...t,...a],[...e,...n],h,E),{scripts:H}=v(t,e,h,b,E,_,f,k,T);console.log(H);const{scripts:D,instructions:L}=v(a,n,h,b,E,_,f,k,T),{oscillographicOffsets:j}=te.getState(),M=Vt.getState().characteristicTypeData,B=ho({flexLogic:{logic1:{nodes:t.map(Te),edges:e.map(ke)},logic2:{nodes:a.map(Te),edges:n.map(ke)}},scripts_1ms:H,scripts_250us:D,instructions:L,setpoints:Be.getState().setpointsValues,indications:l,inputMatrixData:m,offsetsOsc:j,sms:c,smsWeb:u,phoneNumber:p,characteristics:M});console.log(B),console.log(B.flexLogic),d({...B}),o(),r(),P(`Конфигурация рассчитана! Редактор 1: ${H.length} скриптов, Редактор 2: ${D.length} скриптов`,{variant:"success"})}catch(d){throw P(d instanceof Error?d.message:"Ошибка сохранения",{variant:"error"}),d}},sendResConfig:()=>{const{config:d}=ee.getState(),y=Rt.deflate(JSON.stringify(d.flexLogic)),h=btoa(String.fromCharCode(...y)),b={...d,flexLogic:h};console.log(b),console.log(JSON.stringify(b).length),console.log(JSON.stringify(b));const E=ko(JSON.stringify(b),512);i("Отправка конфигурации..."),E.forEach((_,f)=>{setTimeout(()=>s(_),f*1e3)}),i("Конфигурация была отправлена!","in")}}},tr=()=>{const[t,e]=mt(s=>[s.updateEdges,s.updateNodes],ot),[o,a]=yt(s=>[s.updateEdges,s.updateNodes],ot);return{exportData:()=>{const{config:s}=ee.getState(),i=Rt.deflate(JSON.stringify(s.flexLogic)),l=btoa(String.fromCharCode(...i)),c={...s,flexLogic:l};kn(JSON.stringify(c),"flexibleLogic.txt","text/plain")},importData:s=>{var c;const i=(c=s.target.files)==null?void 0:c[0];if(!i)return;const l=new FileReader;e([]),t([]),a([]),o([]),l.readAsArrayBuffer(i),l.onload=function(){const u=l.result;if(!u){P("Ошибка сборки данных",{variant:"error"});return}const p=Ze(u);if(!p){P("Ошибка при считывании гибкой логики",{variant:"error"});return}const m=Uint8Array.from(atob(p.flexLogic),_=>_.charCodeAt(0)),w=Rt.inflate(m,{to:"string"});p.flexLogic=JSON.parse(w);const{logic1:v,logic2:I}=p.flexLogic,x=v.nodes.map(At),d=I.nodes.map(At),y=v.edges.map(ht),h=I.edges.map(ht);e(x),t(y),a(d),o(h),tn(p.inputMatrix,x,d),Je(p.outputMatrix,x,d),Qe(p.characteristics);const b=[...x,...d].reduce((_,f)=>{const k=Number(f.id);return k>_?k:_},0),E=[...y,...h].reduce((_,f)=>{const k=Number(f.id);return k>_?k:_},0);console.log(b,E),it.getState().setIdNode(String(b)),it.getState().setIdEdge(String(E))}}}},To="_disabled_1h3jv_95",So="_ie_1h3jv_119",er={"action-panel":"_action-panel_1h3jv_1","icon-block":"_icon-block_1h3jv_19","action-icon":"_action-icon_1h3jv_77",disabled:To,ie:So,"button-tooltip":"_button-tooltip_1h3jv_187"};function nr(t){return re({attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Export"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M5.552,20.968a2.577,2.577,0,0,1-2.5-2.73c-.012-2.153,0-4.306,0-6.459a.5.5,0,0,1,1,0c0,2.2-.032,4.4,0,6.6.016,1.107.848,1.589,1.838,1.589H18.353A1.546,1.546,0,0,0,19.825,19a3.023,3.023,0,0,0,.1-1.061V11.779h0a.5.5,0,0,1,1,0c0,2.224.085,4.465,0,6.687a2.567,2.567,0,0,1-2.67,2.5Z"},child:[]},{tag:"path",attr:{d:"M12.337,3.176a.455.455,0,0,0-.311-.138c-.015,0-.028,0-.043-.006s-.027,0-.041.006a.457.457,0,0,0-.312.138L7.961,6.845a.5.5,0,0,0,.707.707l2.816-2.815V15.479a.5.5,0,0,0,1,0V4.737L15.3,7.552a.5.5,0,0,0,.707-.707Z"},child:[]}]}]}]})(t)}function ar(t){return re({attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Import"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M5.552,20.968a2.577,2.577,0,0,1-2.5-2.73c-.012-2.153,0-4.306,0-6.459a.5.5,0,0,1,1,0c0,2.2-.032,4.4,0,6.6.016,1.107.848,1.589,1.838,1.589H18.353A1.546,1.546,0,0,0,19.825,19a3.023,3.023,0,0,0,.1-1.061V11.779h0a.5.5,0,0,1,1,0c0,2.224.085,4.465,0,6.687a2.567,2.567,0,0,1-2.67,2.5Z"},child:[]},{tag:"path",attr:{d:"M11.63,15.818a.459.459,0,0,0,.312.138c.014,0,.027.005.042.006s.027,0,.041-.006a.457.457,0,0,0,.312-.138l3.669-3.669a.5.5,0,0,0-.707-.707l-2.815,2.815V3.515a.5.5,0,0,0-1,0V14.257L8.668,11.442a.5.5,0,0,0-.707.707Z"},child:[]}]}]}]})(t)}const No=t=>{const e={type:t.type,inputHandles:t.inputHandles,outputHandles:t.outputHandles,...t.name&&{name:t.name}};return"lengthMemory"in t?{...e,lengthMemory:t.lengthMemory}:"digit"in t?{...e,digit:t.digit}:"setpointDataType"in t?{...e,setpointDataType:t.setpointDataType,setpointValue:t.setpointValue}:e},or=(t,e)=>{const o=Un[t];if(!o)return P(`Неизвестный тип узла: ${t}`,{variant:"error"}),null;const a=No(o);return a?{id:it.getState().getIdNode(),type:"node",position:e,data:{...a}}:(P("Не удалось выделить память",{variant:"error"}),null)};function rr(t){return re({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M224 30v256h-64l96 128 96-128h-64V30h-64zM32 434v48h448v-48H32z"},child:[]}]})(t)}const Oo=t=>t;function Ho(t,e=Oo){const o=N.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return N.useDebugValue(o),o}const He=t=>{const e=Tn(t),o=a=>Ho(e,a);return Object.assign(o,e),o},jo=t=>t?He(t):He,Do=jo((t,e)=>({chunks:[],expectedSize:null,isComplete:!1,addChunk:o=>{const a=new Uint8Array(o),{chunks:n,expectedSize:r}=e();if(n.length===0&&a.length===8){const l=new DataView(o),c=l.getUint32(0,!1);if(c!==3235823838)return console.error("Неизвестный префикс",c.toString(16)),!1;const u=l.getUint32(4,!1);return t({expectedSize:u}),console.log(`Шапка получена. Ожидается ${u} байт данных`),!1}if(r===null)return console.error("Получены данные без шапки!"),!1;const s=[...n,a],i=s.reduce((l,c)=>l+c.length,0);return i>=r?(t({chunks:s,isComplete:!0}),console.log(`Все данные получены: ${i} / ${r} байт`),!0):(t({chunks:s}),console.log(`Получено ${i} / ${r} байт`),!1)},getCompleteBuffer:()=>{const{isComplete:o,chunks:a}=e();if(!o)return null;const n=a.reduce((i,l)=>i+l.length,0),r=new Uint8Array(n);let s=0;for(const i of a)r.set(i,s),s+=i.length;return r.buffer},reset:()=>{t({chunks:[],expectedSize:null,isComplete:!1})}})),sr=t=>{const{addChunk:e,getCompleteBuffer:o,reset:a}=Do.getState();if(!e(t.target.value.buffer))return;const r=o();if(console.log("вывод того что получили: ",new TextDecoder().decode(r)),!r){P("Ошибка сборки данных",{variant:"error"}),a();return}const s=Ze(r);if(!s){P("Ошибка при считывании гибкой логики",{variant:"error"}),a();return}const i=Uint8Array.from(atob(s.flexLogic),h=>h.charCodeAt(0)),l=Rt.inflate(i,{to:"string"});s.flexLogic=JSON.parse(l);const{logic1:c,logic2:u}=s.flexLogic;console.log(s);const p=c.nodes.map(At),m=u.nodes.map(At),w=c.edges.map(ht),v=u.edges.map(ht);mt.getState().updateNodes(p),yt.getState().updateNodes(m),tn(s.inputMatrix,p,m),Je(s.outputMatrix,p,m),Qe(s.characteristics),mt.getState().updateEdges(c.edges.map(ht)),yt.getState().updateEdges(u.edges.map(ht));const x=[...p,...m].reduce((h,b)=>{const E=Number(b.id);return E>h?E:h},0),y=[...w,...v].reduce((h,b)=>{const E=Number(b.id);return E>h?E:h},0);console.log(x),it.getState().setIdNode(String(x)),it.getState().setIdEdge(String(y)),P("Гибкая логика загружена",{variant:"success"}),a()};export{ar as C,rr as G,Jo as L,Uo as S,Qo as a,_a as b,tr as c,nr as d,zo as e,Do as f,or as g,sr as h,qo as i,Zo as j,Yo as k,Go as l,Un as n,Xo as p,er as s,Ko as u};
