import{r as x,j as s}from"./index-DLXaYNgL.js";import{T as w}from"./Table-D4lejGsZ.js";import{n as g}from"./index-BQ57Tzki.js";import{u as I}from"./store-Dsl6ybKP.js";import{g as y}from"./helpers-fab74NUc.js";import{I as R}from"./Input-C8sIWxw4.js";import{C as M}from"./CheckBox-CJiqrj1_.js";import{s as T}from"./shallow-96V0Rfcy.js";const v=({id:n,value:o})=>{const[d,u]=g(r=>[r.nodes,r.updateNodes]),i=x.useMemo(()=>d.find(r=>r.id===n),[d]);if(!i)return s.jsx("div",{children:"узел не найден"});const a=r=>{const m={...i,data:{...i==null?void 0:i.data,name:r}},l=d.map(C=>C.id===m.id?m:C);u(l)};return s.jsx(R,{value:o,onChange:r=>a(r.target.value)})},E=({characteristic:n,field:o})=>{const[d,u]=I(a=>[a.setCharacteristicTypeData,a.characteristicTypeData],T),i=a=>{Number(a)&&d(n,o,Number(a))};return s.jsx(R,{value:u[n][o],onChange:a=>i(a.target.value)})},D={I:0,U:0,HRM3:0},A={characteristic:"U",k:0,const:0},j=["id","name"],_=()=>{const{datas:n,setDatas:o,characteristicTypeData:d}=I(t=>({datas:t.datas,setDatas:t.setDatas,characteristicTypeData:t.characteristicTypeData,setCharacteristicTypeData:t.setCharacteristicTypeData}),T),u=g(t=>t.nodes,T);x.useEffect(()=>{const e=u.filter(c=>{var h,p;return(p=(h=c==null?void 0:c.data)==null?void 0:h.type)==null?void 0:p.toLowerCase().includes("input")}).reduce((c,h)=>(c[h.id]={...n[h.id]??D,id:h.id,name:h.data.name??""},c),{});o(e)},[u]);const i=x.useMemo(()=>Object.values(n),[n]),a=x.useMemo(()=>y({id:"",name:"",...D}),[]),r=x.useMemo(()=>y({...A}),[]),m=()=>a.map(t=>s.jsx("th",{children:t},t)),l=()=>r.map(t=>s.jsx("th",{children:t},t)),C=(t,e)=>{const c=n[t];Object.entries(c).some(([p,b])=>p!==e&&!j.includes(p)&&b===1)&&c[e]===0||o({...n,[t]:{...c,[e]:c[e]?0:1}})},N=(t,e)=>{j.includes(e)||C(t,e)};return{renderHead:m,renderRow:t=>s.jsx(s.Fragment,{children:a.map(e=>{const c=!j.includes(e);return s.jsx("td",{style:{cursor:c?"pointer":"default"},children:e==="name"?s.jsx(v,{value:t.name,id:t.id}):c?s.jsx(M,{checked:!!t[e],onChange:()=>N(t.id,e)}):t[e]},e)})}),rows:i,characteristicTypeData:d,renderRowCharacteristic:t=>r.map(e=>s.jsx("td",{children:e==="characteristic"?t[e]:s.jsx(E,{characteristic:t.characteristic,field:e})},e)),renderHeadCharacteristics:l}},F={"table-row":"_table-row_14doo_1"},H=()=>{const{renderHead:n,renderRow:o,rows:d,characteristicTypeData:u,renderRowCharacteristic:i,renderHeadCharacteristics:a}=_();return s.jsxs("div",{className:F["table-row"],children:[s.jsx(w,{renderRow:o,renderHead:n,rowItems:d,getRowKey:r=>r.id,maxWidth:1100}),s.jsx(w,{renderRow:i,renderHead:a,rowItems:Object.entries(u).map(([r,m])=>({characteristic:r,const:m.const,k:m.k})),getRowKey:r=>r.characteristic,maxWidth:1100})]})},P=({})=>s.jsx("div",{children:s.jsx(H,{})});export{P as default};
