import{r as x,j as n}from"./index-DG-hptjM.js";import{T as M}from"./Table-a0C-Ph7B.js";import{n as v}from"./index-C6wO-Flz.js";import{u as N}from"./store-D2gvsguz.js";import{g as f}from"./helpers-C0jkC3_s.js";import{I as w}from"./Input-DOCzMZNl.js";import{C as E}from"./CheckBox-B4irW3p1.js";import{s as I}from"./shallow-CjbkFOmN.js";import"./v4-C6aID195.js";const R=({id:o,value:d})=>{const[a,u]=v(r=>[r.nodes,r.updateNodes]),i=x.useMemo(()=>a.find(r=>r.id===o),[a]);if(!i)return n.jsx("div",{children:"узел не найден"});const h=r=>{const p={...i,data:{...i==null?void 0:i.data,name:r}},j=a.map(t=>t.id===p.id?p:t);u(j)};return n.jsx(w,{value:d,onChange:r=>h(r.target.value)})},g={I:0,U:0,HRM3:0},l=["id","name"],A=()=>{const{datas:o,setDatas:d}=N(t=>({datas:t.datas,setDatas:t.setDatas}),I),a=v(t=>t.nodes,I);x.useEffect(()=>{const e=a.filter(s=>{var c,m;return(m=(c=s==null?void 0:s.data)==null?void 0:c.type)==null?void 0:m.toLowerCase().includes("input")}).reduce((s,c)=>(s[c.id]={...o[c.id]??g,id:c.id,name:c.data.name??""},s),{});d(e)},[a]);const u=x.useMemo(()=>Object.values(o),[o]),i=x.useMemo(()=>f({id:"",name:"",...g}),[]),h=()=>i.map(t=>n.jsx("th",{children:t},t)),r=(t,e)=>{const s=o[t];Object.entries(s).some(([m,C])=>m!==e&&!l.includes(m)&&C===1)&&s[e]===0||d({...o,[t]:{...s,[e]:s[e]?0:1}})},p=(t,e)=>{l.includes(e)||r(t,e)};return{renderHead:h,renderRow:t=>n.jsx(n.Fragment,{children:i.map(e=>{const s=!l.includes(e);return n.jsx("td",{style:{cursor:s?"pointer":"default"},children:e==="name"?n.jsx(R,{value:t.name,id:t.id}):s?n.jsx(E,{checked:!!t[e],onChange:()=>p(t.id,e)}):t[e]},e)})}),rows:u}},D=()=>{const{renderHead:o,renderRow:d,rows:a}=A();return n.jsx("div",{children:n.jsx(M,{renderRow:d,renderHead:o,rowItems:a,getRowKey:u=>u.id,maxWidth:1100})})},_=({})=>n.jsx("div",{children:n.jsx(D,{})});export{_ as default};
