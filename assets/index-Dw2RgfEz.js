import{r as h,j as e}from"./index-C3qQ2WG5.js";import{T as y}from"./Table-DeRMuZrL.js";import{n as j}from"./index-oxxnVM7F.js";import{g as F}from"./helpers-fab74NUc.js";import{I as N}from"./Input-qp2eISqQ.js";import{i as g,a as V}from"./store-BJgV7beU.js";import{s as S}from"./shallow-D7DO0VyS.js";const w=(s,r,u)=>{if(!("setpointDataType"in r)||r.type!=="fourierInt")return;const[c,t]=h.useState([...r.setpointValue]),i=h.useCallback(d=>{u(s,{setpointValue:d})},[s,u]);return{inputsValue:c,handleFourierGarmonicForOutput:(d,p)=>{if(g(p)){const n=Number(p);if(!Number.isNaN(n)&&n>=0&&n<=19){const a=[...c];a[d]=n,i([...a]),t([...a])}}}}},C=(s,r,u)=>{if(!("setpointDataType"in r)||Array.isArray(r.setpointValue))return;const{setpointDataType:c}=r,[t,i]=h.useState(String(r.setpointValue)),o=h.useCallback(n=>{u(s,{setpointValue:n})},[s,u]),d=(n,a)=>{if(n===""||n==="-"||n==="."||n==="-.")return n;a&&(n=n.replace(",","."));const l=Number(n);return Number.isNaN(l)?n:String(l)};return{handleChange:n=>{let a=n.target.value;switch(c){case"int":if(g(a)){const f=d(a,!1);i(f);const x=Number(f);Number.isNaN(x)||o(x)}break;case"float":if(V(a)){const f=d(a,!0);i(f);const x=Number(f);Number.isNaN(x)||o(x)}break;case"bool":const m=n.target.checked?1:0;o(m),i(String(m));break}},inputValue:t}},b=({id:s,value:r})=>{const[u,c]=j(o=>[o.nodes,o.updateNodes]),t=h.useMemo(()=>u.find(o=>o.id===s),[u]);if(!t)return e.jsx("div",{children:"узел не найден"});const i=o=>{const d={...t,data:{...t==null?void 0:t.data,name:o}},p=u.map(n=>n.id===d.id?d:n);c(p)};return e.jsx(N,{value:r,onChange:o=>i(o.target.value)})},T=({id:s,data:r})=>{const[u]=j(p=>[p.setNodeData]),{type:c,name:t}=r,i=C(s,r,u);if(!i)return e.jsx(e.Fragment,{});const{handleChange:o,inputValue:d}=i;return e.jsxs(e.Fragment,{children:[e.jsx("td",{children:s},0),e.jsx("td",{children:c},1),e.jsx("td",{children:e.jsx(b,{value:t??"",id:s})},2),e.jsx("td",{children:e.jsx(N,{type:"text",value:d,onChange:o})},3)]})},k=({id:s,data:r})=>{const[u]=j(a=>[a.setNodeData]),{type:c,name:t,outputHandles:i}=r,o=w(s,r,u);if(!o)return e.jsx(e.Fragment,{});const{handleFourierGarmonicForOutput:d,inputsValue:p}=o,n=Object.values(i).reduce((a,l,m)=>(m%2===0?a.push([l]):a[a.length-1].push(l),a),[]);return e.jsxs(e.Fragment,{children:[e.jsx("td",{children:s},0),e.jsx("td",{children:c},1),e.jsx("td",{children:e.jsx(b,{value:t??"",id:s})},2),e.jsx("td",{style:{display:"flex",gap:"10px"},children:n.map((a,l)=>e.jsx(N,{style:{width:"60px"},type:"number",value:p[l],onChange:m=>d(l,m.target.value)},l))},3)]})},R={id:"",type:"",name:"",value:0};function D(s){return"setpointDataType"in s.data}const E=()=>{const s=j(t=>t.nodes,S),r=h.useMemo(()=>s.filter(i=>D(i)).map(i=>({id:i.id,data:i.data})),[s]);return{renderHead:()=>e.jsx(e.Fragment,{children:F(R).map(t=>e.jsx("th",{children:t},t))}),rows:r,renderRow:t=>t.data.type==="fourierInt"?e.jsx(k,{id:t.id,data:t.data}):e.jsx(T,{id:t.id,data:t.data})}},I=({})=>{const{renderHead:s,rows:r,renderRow:u}=E();return e.jsx("div",{children:e.jsx(y,{rowItems:r,renderHead:s,renderRow:u,getRowKey:c=>c.id,maxWidth:1e3})})},K=()=>e.jsx("div",{children:e.jsx(I,{})});export{K as default};
