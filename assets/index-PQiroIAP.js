import{r as C,j as a}from"./index-5v0WUSE6.js";import{T as D}from"./Table-BPGW_6oS.js";import{u as R,b}from"./store2-B2nLEZdA.js";import{u as M}from"./store-DWPSX4g-.js";import{g}from"./helpers-fab74NUc.js";import{I as E}from"./Input-C2xJGQu9.js";import{s as j}from"./shallow-BbWNg5yE.js";import{C as A}from"./CheckBox-Dc0LcTKS.js";const _=({id:c,value:u})=>{const{nodes:m,updateNodes:h}=R(s=>({nodes:s.nodes,updateNodes:s.updateNodes}),j),{nodes2:d,updateNodes2:o}=b(s=>({nodes2:s.nodes,updateNodes2:s.updateNodes}),j),r=C.useMemo(()=>m.find(s=>s.id===c),[m]),i=C.useMemo(()=>d.find(s=>s.id===c),[d]);if(!r&&!i)return a.jsx("div",{children:"узел не найден"});const T=r?s=>{const x={...r,data:{...r==null?void 0:r.data,name:s}},N=m.map(l=>l.id===x.id?x:l);h(N)}:i?s=>{const x={...i,data:{...i==null?void 0:i.data,name:s}},N=d.map(l=>l.id===x.id?x:l);o(N)}:()=>{};return a.jsx(E,{value:u,onChange:s=>T(s.target.value)})},F=({characteristic:c,field:u})=>{const[m,h]=M(o=>[o.setCharacteristicTypeData,o.characteristicTypeData],j),d=o=>{Number(o)&&m(c,u,Number(o))};return a.jsx(E,{value:h[c][u],onChange:o=>d(o.target.value)})},I={I:0,U:0,HRM3:0},H={characteristic:"U",k:0,const:0},y=["id","name"],O=()=>{const{datas:c,setDatas:u,characteristicTypeData:m}=M(e=>({datas:e.datas,setDatas:e.setDatas,characteristicTypeData:e.characteristicTypeData,setCharacteristicTypeData:e.setCharacteristicTypeData}),j),h=R(e=>e.nodes,j),d=b(e=>e.nodes,j);C.useEffect(()=>{const t=[...h,...d].filter(n=>{var p,w;return(w=(p=n==null?void 0:n.data)==null?void 0:p.type)==null?void 0:w.toLowerCase().includes("input")}).reduce((n,p)=>(n[p.id]={...c[p.id]??I,id:p.id,name:p.data.name??""},n),{});u(t)},[h,d]);const o=C.useMemo(()=>Object.values(c),[c]),r=C.useMemo(()=>g({id:"",name:"",...I}),[]),i=C.useMemo(()=>g({...H}),[]),T=()=>r.map(e=>a.jsx("th",{children:e},e)),s=()=>i.map(e=>a.jsx("th",{children:e},e)),x=(e,t)=>{const n=c[e];Object.entries(n).some(([w,v])=>w!==t&&!y.includes(w)&&v===1)&&n[t]===0||u({...c,[e]:{...n,[t]:n[t]?0:1}})},N=(e,t)=>{y.includes(t)||x(e,t)};return{renderHead:T,renderRow:e=>a.jsx(a.Fragment,{children:r.map(t=>{const n=!y.includes(t);return a.jsx("td",{style:{cursor:n?"pointer":"default"},children:t==="name"?a.jsx(_,{value:e.name,id:e.id}):n?a.jsx(A,{checked:!!e[t],onChange:()=>N(e.id,t)}):e[t]},t)})}),rows:o,characteristicTypeData:m,renderRowCharacteristic:e=>i.map(t=>a.jsx("td",{children:t==="characteristic"?e[t]:a.jsx(F,{characteristic:e.characteristic,field:t})},t)),renderHeadCharacteristics:s}},S={"table-row":"_table-row_14doo_1"},f=()=>{const{renderHead:c,renderRow:u,rows:m,characteristicTypeData:h,renderRowCharacteristic:d,renderHeadCharacteristics:o}=O();return a.jsxs("div",{className:S["table-row"],children:[a.jsx(D,{style:{minWidth:"450px"},renderRow:u,renderHead:c,rowItems:m,getRowKey:r=>r.id,maxWidth:1100}),a.jsx(D,{renderRow:d,renderHead:o,rowItems:Object.entries(h).map(([r,i])=>({characteristic:r,const:i.const,k:i.k})),getRowKey:r=>r.characteristic})]})},z=({})=>a.jsx("div",{children:a.jsx(f,{})});export{z as default};
