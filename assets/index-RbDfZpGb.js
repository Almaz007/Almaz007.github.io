import{r as x,j as r}from"./index-uAQlHVlY.js";import{T as y}from"./Table-B9xhZmB1.js";import{n as g}from"./index-AV0xX4M8.js";import{u as I}from"./store-CZPUAncB.js";import{g as w}from"./helpers-fab74NUc.js";import{I as R}from"./Input-BNUv9bAr.js";import{C as M}from"./CheckBox-BnDR3RHn.js";import{s as T}from"./shallow-vNVvJPD-.js";const v=({id:n,value:o})=>{const[d,u]=g(s=>[s.nodes,s.updateNodes]),i=x.useMemo(()=>d.find(s=>s.id===n),[d]);if(!i)return r.jsx("div",{children:"узел не найден"});const a=s=>{const m={...i,data:{...i==null?void 0:i.data,name:s}},C=d.map(l=>l.id===m.id?m:l);u(C)};return r.jsx(R,{value:o,onChange:s=>a(s.target.value)})},E=({characteristic:n,field:o})=>{const[d,u]=I(a=>[a.setCharacteristicTypeData,a.characteristicTypeData],T),i=a=>{Number(a)&&d(n,o,Number(a))};return r.jsx(R,{value:u[n][o],onChange:a=>i(a.target.value)})},D={I:0,U:0,HRM3:0},A={characteristic:"U",k:0,const:0},j=["id","name"],_=()=>{const{datas:n,setDatas:o,characteristicTypeData:d}=I(t=>({datas:t.datas,setDatas:t.setDatas,characteristicTypeData:t.characteristicTypeData,setCharacteristicTypeData:t.setCharacteristicTypeData}),T),u=g(t=>t.nodes,T);x.useEffect(()=>{const e=u.filter(c=>{var h,p;return(p=(h=c==null?void 0:c.data)==null?void 0:h.type)==null?void 0:p.toLowerCase().includes("input")}).reduce((c,h)=>(c[h.id]={...n[h.id]??D,id:h.id,name:h.data.name??""},c),{});o(e)},[u]);const i=x.useMemo(()=>Object.values(n),[n]),a=x.useMemo(()=>w({id:"",name:"",...D}),[]),s=x.useMemo(()=>w({...A}),[]),m=()=>a.map(t=>r.jsx("th",{children:t},t)),C=()=>s.map(t=>r.jsx("th",{children:t},t)),l=(t,e)=>{const c=n[t];Object.entries(c).some(([p,b])=>p!==e&&!j.includes(p)&&b===1)&&c[e]===0||o({...n,[t]:{...c,[e]:c[e]?0:1}})},N=(t,e)=>{j.includes(e)||l(t,e)};return{renderHead:m,renderRow:t=>r.jsx(r.Fragment,{children:a.map(e=>{const c=!j.includes(e);return r.jsx("td",{style:{cursor:c?"pointer":"default"},children:e==="name"?r.jsx(v,{value:t.name,id:t.id}):c?r.jsx(M,{checked:!!t[e],onChange:()=>N(t.id,e)}):t[e]},e)})}),rows:i,characteristicTypeData:d,renderRowCharacteristic:t=>s.map(e=>r.jsx("td",{children:e==="characteristic"?t[e]:r.jsx(E,{characteristic:t.characteristic,field:e})},e)),renderHeadCharacteristics:C}},F={"table-row":"_table-row_14doo_1"},H=()=>{const{renderHead:n,renderRow:o,rows:d,characteristicTypeData:u,renderRowCharacteristic:i,renderHeadCharacteristics:a}=_();return r.jsxs("div",{className:F["table-row"],children:[r.jsx(y,{style:{minWidth:"450px"},renderRow:o,renderHead:n,rowItems:d,getRowKey:s=>s.id,maxWidth:1100}),r.jsx(y,{renderRow:i,renderHead:a,rowItems:Object.entries(u).map(([s,m])=>({characteristic:s,const:m.const,k:m.k})),getRowKey:s=>s.characteristic})]})},P=({})=>r.jsx("div",{children:r.jsx(H,{})});export{P as default};
